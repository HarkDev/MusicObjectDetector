**********************
Windows PowerShell transcript start
Start time: 20171129102422
Username: ADS\alpa
RunAs User: ADS\alpa
Machine: VIEN0054 (Microsoft Windows NT 10.0.15063.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -Command if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\Users\alpa\Repositories\MusicObjectDetector\TrainModel.ps1'
Process ID: 9964
PSVersion: 5.1.15063.726
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.15063.726
BuildVersion: 10.0.15063.726
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
Transcript started, output file is C:\Users\alpa\Repositories\MusicObjectDetector\2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.txt
Using TensorFlow backend.
2017-11-29 10:24:24.821979: I C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\36\tensorflow\core\platform\cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow bina
ry was not compiled to use: AVX AVX2
2017-11-29 10:24:25.655518: I C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\36\tensorflow\core\common_runtime\gpu\gpu_device.cc:1030] Found device 0 with properties:
name: Quadro M2000M major: 5 minor: 0 memoryClockRate(GHz): 1.137
pciBusID: 0000:01:00.0
totalMemory: 4.00GiB freeMemory: 3.35GiB
2017-11-29 10:24:25.655852: I C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\36\tensorflow\core\common_runtime\gpu\gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (devic
e: 0, name: Quadro M2000M, pci bus id: 0000:01:00.0, compute capability: 5.0)
Parsing annotation file: 100%|███████████████████████████████████████████████| 106893/106893 [00:16<00:00, 6671.38it/s]
Training images per class:
{'16th_flag': 603,
 '16th_rest': 506,
 '8th_flag': 2569,
 '8th_rest': 1325,
 'accent': 292,
 'arpeggio_wobble': 25,
 'beam': 7208,
 'bg': 0,
 'breath_mark': 15,
 'c-clef': 189,
 'curved-line_(tie-or-slur)': 1,
 'dotted_horizontal_spanner': 3,
 'double_sharp': 42,
 'duration-dot': 2568,
 'dynamics_text': 839,
 'f-clef': 285,
 'fermata': 38,
 'flat': 1311,
 'g-clef': 402,
 'glissando': 28,
 'grace-notehead-full': 421,
 'grace_strikethrough': 83,
 'hairpin-cresc': 208,
 'hairpin-decr': 280,
 'half_rest': 241,
 'instrument_specific': 63,
 'key_signature': 698,
 'ledger_line': 8460,
 'letter_A': 12,
 'letter_C': 6,
 'letter_E': 2,
 'letter_F': 25,
 'letter_L': 16,
 'letter_M': 72,
 'letter_P': 120,
 'letter_R': 45,
 'letter_S': 1,
 'letter_T': 20,
 'letter_V': 6,
 'letter_a': 101,
 'letter_b': 8,
 'letter_c': 286,
 'letter_d': 224,
 'letter_e': 611,
 'letter_f': 636,
 'letter_g': 24,
 'letter_i': 112,
 'letter_j': 12,
 'letter_l': 109,
 'letter_m': 186,
 'letter_n': 111,
 'letter_o': 429,
 'letter_other': 39,
 'letter_p': 664,
 'letter_r': 505,
 'letter_s': 448,
 'letter_t': 346,
 'letter_u': 69,
 'letter_v': 13,
 'letter_x': 12,
 'letter_z': 52,
 'measure_separator': 2831,
 'multi-measure_rest': 50,
 'multi-staff_brace': 34,
 'multi-staff_bracket': 2,
 'multiple-note_tremolo': 126,
 'natural': 1295,
 'notehead-empty': 1978,
 'notehead-full': 25606,
 'numeral_0': 9,
 'numeral_1': 17,
 'numeral_2': 40,
 'numeral_3': 405,
 'numeral_4': 155,
 'numeral_5': 11,
 'numeral_6': 32,
 'numeral_7': 22,
 'numeral_8': 34,
 'ornament(s)': 87,
 'other-clef': 5,
 'other-dot': 286,
 'other_numeric_sign': 16,
 'other_text': 315,
 'quarter_rest': 959,
 'repeat': 77,
 'repeat-dot': 359,
 'repeat_measure': 18,
 'sharp': 2322,
 'slur': 2731,
 'staccato-dot': 1845,
 'staff_grouping': 41,
 'stem': 25658,
 'tempo_text': 113,
 'tenuto': 156,
 'thick_barline': 40,
 'thin_barline': 3290,
 'tie': 800,
 'time_signature': 221,
 'transposition_text': 4,
 'trill': 228,
 'trill_wobble': 42,
 'tuple': 303,
 'tuple_bracketline': 56,
 'unclassified': 30,
 'whole-time_mark': 36,
 'whole_rest': 183}
Num classes (including bg) = 106
Hyperparameters: 128 RoIs generated per run with 600 boxes remaining from non-max suppression and using non-max suppression threshold of 0.70
Config has been written to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.pickle, and can be loaded when testing to ensure correct results
Number of training samples: 4275
Number of validation samples: 534
Number of test samples: 537
Using fast data_generator
2017-11-29 10:24:49.536934: I C:\tf_jenkins\home\workspace\rel-win\M\windows-gpu\PY\36\tensorflow\core\common_runtime\gpu\gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (devic
e: 0, name: Quadro M2000M, pci bus id: 0000:01:00.0, compute capability: 5.0)
Loading weights from None
Could not load pretrained model weights. Weights can be found in the keras application folder             https://github.com/fchollet/keras/tree/master/keras/applications
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, None, None, 3 0
__________________________________________________________________________________________________
zero_padding2d_1 (ZeroPadding2D (None, None, None, 3 0           input_1[0][0]
__________________________________________________________________________________________________
conv1 (Conv2D)                  (None, None, None, 6 9472        zero_padding2d_1[0][0]
__________________________________________________________________________________________________
bn_conv1 (FixedBatchNormalizati (None, None, None, 6 256         conv1[0][0]
__________________________________________________________________________________________________
activation_1 (Activation)       (None, None, None, 6 0           bn_conv1[0][0]
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, None, None, 6 0           activation_1[0][0]
__________________________________________________________________________________________________
res2a_branch2a (Conv2D)         (None, None, None, 6 4160        max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2a (FixedBatchNormal (None, None, None, 6 256         res2a_branch2a[0][0]
__________________________________________________________________________________________________
activation_2 (Activation)       (None, None, None, 6 0           bn2a_branch2a[0][0]
__________________________________________________________________________________________________
res2a_branch2b (Conv2D)         (None, None, None, 6 36928       activation_2[0][0]
__________________________________________________________________________________________________
bn2a_branch2b (FixedBatchNormal (None, None, None, 6 256         res2a_branch2b[0][0]
__________________________________________________________________________________________________
activation_3 (Activation)       (None, None, None, 6 0           bn2a_branch2b[0][0]
__________________________________________________________________________________________________
res2a_branch2c (Conv2D)         (None, None, None, 2 16640       activation_3[0][0]
__________________________________________________________________________________________________
res2a_branch1 (Conv2D)          (None, None, None, 2 16640       max_pooling2d_1[0][0]
__________________________________________________________________________________________________
bn2a_branch2c (FixedBatchNormal (None, None, None, 2 1024        res2a_branch2c[0][0]
__________________________________________________________________________________________________
bn2a_branch1 (FixedBatchNormali (None, None, None, 2 1024        res2a_branch1[0][0]
__________________________________________________________________________________________________
add_1 (Add)                     (None, None, None, 2 0           bn2a_branch2c[0][0]
                                                                 bn2a_branch1[0][0]
__________________________________________________________________________________________________
activation_4 (Activation)       (None, None, None, 2 0           add_1[0][0]
__________________________________________________________________________________________________
res2b_branch2a (Conv2D)         (None, None, None, 6 16448       activation_4[0][0]
__________________________________________________________________________________________________
bn2b_branch2a (FixedBatchNormal (None, None, None, 6 256         res2b_branch2a[0][0]
__________________________________________________________________________________________________
activation_5 (Activation)       (None, None, None, 6 0           bn2b_branch2a[0][0]
__________________________________________________________________________________________________
res2b_branch2b (Conv2D)         (None, None, None, 6 36928       activation_5[0][0]
__________________________________________________________________________________________________
bn2b_branch2b (FixedBatchNormal (None, None, None, 6 256         res2b_branch2b[0][0]
__________________________________________________________________________________________________
activation_6 (Activation)       (None, None, None, 6 0           bn2b_branch2b[0][0]
__________________________________________________________________________________________________
res2b_branch2c (Conv2D)         (None, None, None, 2 16640       activation_6[0][0]
__________________________________________________________________________________________________
bn2b_branch2c (FixedBatchNormal (None, None, None, 2 1024        res2b_branch2c[0][0]
__________________________________________________________________________________________________
add_2 (Add)                     (None, None, None, 2 0           bn2b_branch2c[0][0]
                                                                 activation_4[0][0]
__________________________________________________________________________________________________
activation_7 (Activation)       (None, None, None, 2 0           add_2[0][0]
__________________________________________________________________________________________________
res2c_branch2a (Conv2D)         (None, None, None, 6 16448       activation_7[0][0]
__________________________________________________________________________________________________
bn2c_branch2a (FixedBatchNormal (None, None, None, 6 256         res2c_branch2a[0][0]
__________________________________________________________________________________________________
activation_8 (Activation)       (None, None, None, 6 0           bn2c_branch2a[0][0]
__________________________________________________________________________________________________
res2c_branch2b (Conv2D)         (None, None, None, 6 36928       activation_8[0][0]
__________________________________________________________________________________________________
bn2c_branch2b (FixedBatchNormal (None, None, None, 6 256         res2c_branch2b[0][0]
__________________________________________________________________________________________________
activation_9 (Activation)       (None, None, None, 6 0           bn2c_branch2b[0][0]
__________________________________________________________________________________________________
res2c_branch2c (Conv2D)         (None, None, None, 2 16640       activation_9[0][0]
__________________________________________________________________________________________________
bn2c_branch2c (FixedBatchNormal (None, None, None, 2 1024        res2c_branch2c[0][0]
__________________________________________________________________________________________________
add_3 (Add)                     (None, None, None, 2 0           bn2c_branch2c[0][0]
                                                                 activation_7[0][0]
__________________________________________________________________________________________________
activation_10 (Activation)      (None, None, None, 2 0           add_3[0][0]
__________________________________________________________________________________________________
res3a_branch2a (Conv2D)         (None, None, None, 1 32896       activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2a (FixedBatchNormal (None, None, None, 1 512         res3a_branch2a[0][0]
__________________________________________________________________________________________________
activation_11 (Activation)      (None, None, None, 1 0           bn3a_branch2a[0][0]
__________________________________________________________________________________________________
res3a_branch2b (Conv2D)         (None, None, None, 1 147584      activation_11[0][0]
__________________________________________________________________________________________________
bn3a_branch2b (FixedBatchNormal (None, None, None, 1 512         res3a_branch2b[0][0]
__________________________________________________________________________________________________
activation_12 (Activation)      (None, None, None, 1 0           bn3a_branch2b[0][0]
__________________________________________________________________________________________________
res3a_branch2c (Conv2D)         (None, None, None, 5 66048       activation_12[0][0]
__________________________________________________________________________________________________
res3a_branch1 (Conv2D)          (None, None, None, 5 131584      activation_10[0][0]
__________________________________________________________________________________________________
bn3a_branch2c (FixedBatchNormal (None, None, None, 5 2048        res3a_branch2c[0][0]
__________________________________________________________________________________________________
bn3a_branch1 (FixedBatchNormali (None, None, None, 5 2048        res3a_branch1[0][0]
__________________________________________________________________________________________________
add_4 (Add)                     (None, None, None, 5 0           bn3a_branch2c[0][0]
                                                                 bn3a_branch1[0][0]
__________________________________________________________________________________________________
activation_13 (Activation)      (None, None, None, 5 0           add_4[0][0]
__________________________________________________________________________________________________
res3b_branch2a (Conv2D)         (None, None, None, 1 65664       activation_13[0][0]
__________________________________________________________________________________________________
bn3b_branch2a (FixedBatchNormal (None, None, None, 1 512         res3b_branch2a[0][0]
__________________________________________________________________________________________________
activation_14 (Activation)      (None, None, None, 1 0           bn3b_branch2a[0][0]
__________________________________________________________________________________________________
res3b_branch2b (Conv2D)         (None, None, None, 1 147584      activation_14[0][0]
__________________________________________________________________________________________________
bn3b_branch2b (FixedBatchNormal (None, None, None, 1 512         res3b_branch2b[0][0]
__________________________________________________________________________________________________
activation_15 (Activation)      (None, None, None, 1 0           bn3b_branch2b[0][0]
__________________________________________________________________________________________________
res3b_branch2c (Conv2D)         (None, None, None, 5 66048       activation_15[0][0]
__________________________________________________________________________________________________
bn3b_branch2c (FixedBatchNormal (None, None, None, 5 2048        res3b_branch2c[0][0]
__________________________________________________________________________________________________
add_5 (Add)                     (None, None, None, 5 0           bn3b_branch2c[0][0]
                                                                 activation_13[0][0]
__________________________________________________________________________________________________
activation_16 (Activation)      (None, None, None, 5 0           add_5[0][0]
__________________________________________________________________________________________________
res3c_branch2a (Conv2D)         (None, None, None, 1 65664       activation_16[0][0]
__________________________________________________________________________________________________
bn3c_branch2a (FixedBatchNormal (None, None, None, 1 512         res3c_branch2a[0][0]
__________________________________________________________________________________________________
activation_17 (Activation)      (None, None, None, 1 0           bn3c_branch2a[0][0]
__________________________________________________________________________________________________
res3c_branch2b (Conv2D)         (None, None, None, 1 147584      activation_17[0][0]
__________________________________________________________________________________________________
bn3c_branch2b (FixedBatchNormal (None, None, None, 1 512         res3c_branch2b[0][0]
__________________________________________________________________________________________________
activation_18 (Activation)      (None, None, None, 1 0           bn3c_branch2b[0][0]
__________________________________________________________________________________________________
res3c_branch2c (Conv2D)         (None, None, None, 5 66048       activation_18[0][0]
__________________________________________________________________________________________________
bn3c_branch2c (FixedBatchNormal (None, None, None, 5 2048        res3c_branch2c[0][0]
__________________________________________________________________________________________________
add_6 (Add)                     (None, None, None, 5 0           bn3c_branch2c[0][0]
                                                                 activation_16[0][0]
__________________________________________________________________________________________________
activation_19 (Activation)      (None, None, None, 5 0           add_6[0][0]
__________________________________________________________________________________________________
res3d_branch2a (Conv2D)         (None, None, None, 1 65664       activation_19[0][0]
__________________________________________________________________________________________________
bn3d_branch2a (FixedBatchNormal (None, None, None, 1 512         res3d_branch2a[0][0]
__________________________________________________________________________________________________
activation_20 (Activation)      (None, None, None, 1 0           bn3d_branch2a[0][0]
__________________________________________________________________________________________________
res3d_branch2b (Conv2D)         (None, None, None, 1 147584      activation_20[0][0]
__________________________________________________________________________________________________
bn3d_branch2b (FixedBatchNormal (None, None, None, 1 512         res3d_branch2b[0][0]
__________________________________________________________________________________________________
activation_21 (Activation)      (None, None, None, 1 0           bn3d_branch2b[0][0]
__________________________________________________________________________________________________
res3d_branch2c (Conv2D)         (None, None, None, 5 66048       activation_21[0][0]
__________________________________________________________________________________________________
bn3d_branch2c (FixedBatchNormal (None, None, None, 5 2048        res3d_branch2c[0][0]
__________________________________________________________________________________________________
add_7 (Add)                     (None, None, None, 5 0           bn3d_branch2c[0][0]
                                                                 activation_19[0][0]
__________________________________________________________________________________________________
activation_22 (Activation)      (None, None, None, 5 0           add_7[0][0]
__________________________________________________________________________________________________
res4a_branch2a (Conv2D)         (None, None, None, 2 131328      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2a (FixedBatchNormal (None, None, None, 2 1024        res4a_branch2a[0][0]
__________________________________________________________________________________________________
activation_23 (Activation)      (None, None, None, 2 0           bn4a_branch2a[0][0]
__________________________________________________________________________________________________
res4a_branch2b (Conv2D)         (None, None, None, 2 590080      activation_23[0][0]
__________________________________________________________________________________________________
bn4a_branch2b (FixedBatchNormal (None, None, None, 2 1024        res4a_branch2b[0][0]
__________________________________________________________________________________________________
activation_24 (Activation)      (None, None, None, 2 0           bn4a_branch2b[0][0]
__________________________________________________________________________________________________
res4a_branch2c (Conv2D)         (None, None, None, 1 263168      activation_24[0][0]
__________________________________________________________________________________________________
res4a_branch1 (Conv2D)          (None, None, None, 1 525312      activation_22[0][0]
__________________________________________________________________________________________________
bn4a_branch2c (FixedBatchNormal (None, None, None, 1 4096        res4a_branch2c[0][0]
__________________________________________________________________________________________________
bn4a_branch1 (FixedBatchNormali (None, None, None, 1 4096        res4a_branch1[0][0]
__________________________________________________________________________________________________
add_8 (Add)                     (None, None, None, 1 0           bn4a_branch2c[0][0]
                                                                 bn4a_branch1[0][0]
__________________________________________________________________________________________________
activation_25 (Activation)      (None, None, None, 1 0           add_8[0][0]
__________________________________________________________________________________________________
res4b_branch2a (Conv2D)         (None, None, None, 2 262400      activation_25[0][0]
__________________________________________________________________________________________________
bn4b_branch2a (FixedBatchNormal (None, None, None, 2 1024        res4b_branch2a[0][0]
__________________________________________________________________________________________________
activation_26 (Activation)      (None, None, None, 2 0           bn4b_branch2a[0][0]
__________________________________________________________________________________________________
res4b_branch2b (Conv2D)         (None, None, None, 2 590080      activation_26[0][0]
__________________________________________________________________________________________________
bn4b_branch2b (FixedBatchNormal (None, None, None, 2 1024        res4b_branch2b[0][0]
__________________________________________________________________________________________________
activation_27 (Activation)      (None, None, None, 2 0           bn4b_branch2b[0][0]
__________________________________________________________________________________________________
res4b_branch2c (Conv2D)         (None, None, None, 1 263168      activation_27[0][0]
__________________________________________________________________________________________________
bn4b_branch2c (FixedBatchNormal (None, None, None, 1 4096        res4b_branch2c[0][0]
__________________________________________________________________________________________________
add_9 (Add)                     (None, None, None, 1 0           bn4b_branch2c[0][0]
                                                                 activation_25[0][0]
__________________________________________________________________________________________________
activation_28 (Activation)      (None, None, None, 1 0           add_9[0][0]
__________________________________________________________________________________________________
res4c_branch2a (Conv2D)         (None, None, None, 2 262400      activation_28[0][0]
__________________________________________________________________________________________________
bn4c_branch2a (FixedBatchNormal (None, None, None, 2 1024        res4c_branch2a[0][0]
__________________________________________________________________________________________________
activation_29 (Activation)      (None, None, None, 2 0           bn4c_branch2a[0][0]
__________________________________________________________________________________________________
res4c_branch2b (Conv2D)         (None, None, None, 2 590080      activation_29[0][0]
__________________________________________________________________________________________________
bn4c_branch2b (FixedBatchNormal (None, None, None, 2 1024        res4c_branch2b[0][0]
__________________________________________________________________________________________________
activation_30 (Activation)      (None, None, None, 2 0           bn4c_branch2b[0][0]
__________________________________________________________________________________________________
res4c_branch2c (Conv2D)         (None, None, None, 1 263168      activation_30[0][0]
__________________________________________________________________________________________________
bn4c_branch2c (FixedBatchNormal (None, None, None, 1 4096        res4c_branch2c[0][0]
__________________________________________________________________________________________________
add_10 (Add)                    (None, None, None, 1 0           bn4c_branch2c[0][0]
                                                                 activation_28[0][0]
__________________________________________________________________________________________________
activation_31 (Activation)      (None, None, None, 1 0           add_10[0][0]
__________________________________________________________________________________________________
res4d_branch2a (Conv2D)         (None, None, None, 2 262400      activation_31[0][0]
__________________________________________________________________________________________________
bn4d_branch2a (FixedBatchNormal (None, None, None, 2 1024        res4d_branch2a[0][0]
__________________________________________________________________________________________________
activation_32 (Activation)      (None, None, None, 2 0           bn4d_branch2a[0][0]
__________________________________________________________________________________________________
res4d_branch2b (Conv2D)         (None, None, None, 2 590080      activation_32[0][0]
__________________________________________________________________________________________________
bn4d_branch2b (FixedBatchNormal (None, None, None, 2 1024        res4d_branch2b[0][0]
__________________________________________________________________________________________________
activation_33 (Activation)      (None, None, None, 2 0           bn4d_branch2b[0][0]
__________________________________________________________________________________________________
res4d_branch2c (Conv2D)         (None, None, None, 1 263168      activation_33[0][0]
__________________________________________________________________________________________________
bn4d_branch2c (FixedBatchNormal (None, None, None, 1 4096        res4d_branch2c[0][0]
__________________________________________________________________________________________________
add_11 (Add)                    (None, None, None, 1 0           bn4d_branch2c[0][0]
                                                                 activation_31[0][0]
__________________________________________________________________________________________________
activation_34 (Activation)      (None, None, None, 1 0           add_11[0][0]
__________________________________________________________________________________________________
res4e_branch2a (Conv2D)         (None, None, None, 2 262400      activation_34[0][0]
__________________________________________________________________________________________________
bn4e_branch2a (FixedBatchNormal (None, None, None, 2 1024        res4e_branch2a[0][0]
__________________________________________________________________________________________________
activation_35 (Activation)      (None, None, None, 2 0           bn4e_branch2a[0][0]
__________________________________________________________________________________________________
res4e_branch2b (Conv2D)         (None, None, None, 2 590080      activation_35[0][0]
__________________________________________________________________________________________________
bn4e_branch2b (FixedBatchNormal (None, None, None, 2 1024        res4e_branch2b[0][0]
__________________________________________________________________________________________________
activation_36 (Activation)      (None, None, None, 2 0           bn4e_branch2b[0][0]
__________________________________________________________________________________________________
res4e_branch2c (Conv2D)         (None, None, None, 1 263168      activation_36[0][0]
__________________________________________________________________________________________________
bn4e_branch2c (FixedBatchNormal (None, None, None, 1 4096        res4e_branch2c[0][0]
__________________________________________________________________________________________________
add_12 (Add)                    (None, None, None, 1 0           bn4e_branch2c[0][0]
                                                                 activation_34[0][0]
__________________________________________________________________________________________________
activation_37 (Activation)      (None, None, None, 1 0           add_12[0][0]
__________________________________________________________________________________________________
res4f_branch2a (Conv2D)         (None, None, None, 2 262400      activation_37[0][0]
__________________________________________________________________________________________________
bn4f_branch2a (FixedBatchNormal (None, None, None, 2 1024        res4f_branch2a[0][0]
__________________________________________________________________________________________________
activation_38 (Activation)      (None, None, None, 2 0           bn4f_branch2a[0][0]
__________________________________________________________________________________________________
res4f_branch2b (Conv2D)         (None, None, None, 2 590080      activation_38[0][0]
__________________________________________________________________________________________________
bn4f_branch2b (FixedBatchNormal (None, None, None, 2 1024        res4f_branch2b[0][0]
__________________________________________________________________________________________________
activation_39 (Activation)      (None, None, None, 2 0           bn4f_branch2b[0][0]
__________________________________________________________________________________________________
res4f_branch2c (Conv2D)         (None, None, None, 1 263168      activation_39[0][0]
__________________________________________________________________________________________________
bn4f_branch2c (FixedBatchNormal (None, None, None, 1 4096        res4f_branch2c[0][0]
__________________________________________________________________________________________________
add_13 (Add)                    (None, None, None, 1 0           bn4f_branch2c[0][0]
                                                                 activation_37[0][0]
__________________________________________________________________________________________________
activation_40 (Activation)      (None, None, None, 1 0           add_13[0][0]
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, None, 4)      0
__________________________________________________________________________________________________
roi_pooling_conv_1 (RoiPoolingC (None, 128, 14, 14,  0           activation_40[0][0]
                                                                 input_2[0][0]
__________________________________________________________________________________________________
res5a_branch2a (TimeDistributed (None, 128, 7, 7, 51 524800      roi_pooling_conv_1[0][0]
__________________________________________________________________________________________________
bn5a_branch2a (TimeDistributed) (None, 128, 7, 7, 51 2048        res5a_branch2a[0][0]
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 128, 7, 7, 51 0           bn5a_branch2a[0][0]
__________________________________________________________________________________________________
res5a_branch2b (TimeDistributed (None, 128, 7, 7, 51 2359808     activation_41[0][0]
__________________________________________________________________________________________________
bn5a_branch2b (TimeDistributed) (None, 128, 7, 7, 51 2048        res5a_branch2b[0][0]
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 128, 7, 7, 51 0           bn5a_branch2b[0][0]
__________________________________________________________________________________________________
res5a_branch2c (TimeDistributed (None, 128, 7, 7, 20 1050624     activation_42[0][0]
__________________________________________________________________________________________________
res5a_branch1 (TimeDistributed) (None, 128, 7, 7, 20 2099200     roi_pooling_conv_1[0][0]
__________________________________________________________________________________________________
bn5a_branch2c (TimeDistributed) (None, 128, 7, 7, 20 8192        res5a_branch2c[0][0]
__________________________________________________________________________________________________
bn5a_branch1 (TimeDistributed)  (None, 128, 7, 7, 20 8192        res5a_branch1[0][0]
__________________________________________________________________________________________________
add_14 (Add)                    (None, 128, 7, 7, 20 0           bn5a_branch2c[0][0]
                                                                 bn5a_branch1[0][0]
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 128, 7, 7, 20 0           add_14[0][0]
__________________________________________________________________________________________________
res5b_branch2a (TimeDistributed (None, 128, 7, 7, 51 1049088     activation_43[0][0]
__________________________________________________________________________________________________
bn5b_branch2a (TimeDistributed) (None, 128, 7, 7, 51 2048        res5b_branch2a[0][0]
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 128, 7, 7, 51 0           bn5b_branch2a[0][0]
__________________________________________________________________________________________________
res5b_branch2b (TimeDistributed (None, 128, 7, 7, 51 2359808     activation_44[0][0]
__________________________________________________________________________________________________
bn5b_branch2b (TimeDistributed) (None, 128, 7, 7, 51 2048        res5b_branch2b[0][0]
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 128, 7, 7, 51 0           bn5b_branch2b[0][0]
__________________________________________________________________________________________________
res5b_branch2c (TimeDistributed (None, 128, 7, 7, 20 1050624     activation_45[0][0]
__________________________________________________________________________________________________
bn5b_branch2c (TimeDistributed) (None, 128, 7, 7, 20 8192        res5b_branch2c[0][0]
__________________________________________________________________________________________________
add_15 (Add)                    (None, 128, 7, 7, 20 0           bn5b_branch2c[0][0]
                                                                 activation_43[0][0]
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 128, 7, 7, 20 0           add_15[0][0]
__________________________________________________________________________________________________
res5c_branch2a (TimeDistributed (None, 128, 7, 7, 51 1049088     activation_46[0][0]
__________________________________________________________________________________________________
bn5c_branch2a (TimeDistributed) (None, 128, 7, 7, 51 2048        res5c_branch2a[0][0]
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 128, 7, 7, 51 0           bn5c_branch2a[0][0]
__________________________________________________________________________________________________
res5c_branch2b (TimeDistributed (None, 128, 7, 7, 51 2359808     activation_47[0][0]
__________________________________________________________________________________________________
bn5c_branch2b (TimeDistributed) (None, 128, 7, 7, 51 2048        res5c_branch2b[0][0]
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 128, 7, 7, 51 0           bn5c_branch2b[0][0]
__________________________________________________________________________________________________
res5c_branch2c (TimeDistributed (None, 128, 7, 7, 20 1050624     activation_48[0][0]
__________________________________________________________________________________________________
bn5c_branch2c (TimeDistributed) (None, 128, 7, 7, 20 8192        res5c_branch2c[0][0]
__________________________________________________________________________________________________
add_16 (Add)                    (None, 128, 7, 7, 20 0           bn5c_branch2c[0][0]
                                                                 activation_46[0][0]
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 128, 7, 7, 20 0           add_16[0][0]
__________________________________________________________________________________________________
avg_pool (TimeDistributed)      (None, 128, 1, 1, 20 0           activation_49[0][0]
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, 128, 2048)    0           avg_pool[0][0]
__________________________________________________________________________________________________
dense_class_106 (TimeDistribute (None, 128, 106)     217194      time_distributed_1[0][0]
__________________________________________________________________________________________________
dense_regress_106 (TimeDistribu (None, 128, 420)     860580      time_distributed_1[0][0]
==================================================================================================
Total params: 24,665,486
Trainable params: 24,559,246
Non-trainable params: 106,240
__________________________________________________________________________________________________
Summary of muscima_pp_4
==============================================
Resizing images, so smallest side has 300 pixel
Anchor box scales: [1, 2, 4, 8, 16, 24], Anchor box ratios: [[1, 1], [0.5, 2.0], [1.414213562373095, 0.7071067811865475]]
Data-augmentation: Horizontal flip: False, vertical flip: False, 90° rotation: False
Image channel mean [0, 0, 0], Image scaling factor 1.0, STD scaling 4.0, classifier regr std [8.0, 8.0, 4.0, 4.0]
Number of ROIs at once: 128, RPN Stride: 16
Is the dataset balanced: False
Region Proposal Network overlap: Minimum 0.3, Maximum 0.7
Classifier overlap: Minimum 0.1, Maximum 0.5

Starting training
Epoch 1/200
Pre-computing anchors for resized images: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4275/4275 [00:03<00:00, 1389.26it/s]
1000/1000 [==============================] - 1719s 2s/step - rpn_cls: 1.6278 - rpn_regr: 1.6660 - detector_cls: 0.3061 - detector_regr: 0.3049
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 7.713
Classifier accuracy for bounding boxes from RPN: 0.9382578125
Loss RPN classifier: 1.0212877857312896
Loss RPN regression: 1.3730395187810063
Loss Detector classifier: 0.32969139015606685
Loss Detector regression: 0.19805784336090437
Elapsed time: 1738.8592126369476
Best loss for training: inf
Total training loss decreased from inf to 2.922, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
Pre-computing anchors for resized images: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 534/534 [00:00<00:00, 1500.21it/s]
534/534 [==============================] - 423s 792ms/step - rpn_cls: 0.5468 - rpn_regr: 1.0835 - detector_cls: 0.3731 - detector_regr: 0.1359
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 13.073446327683616
Classifier accuracy for bounding boxes from RPN: 0.9382578125
Loss RPN classifier: 0.583374129754256
Loss RPN regression: 1.111453939717584
Loss Detector classifier: 0.3818466618678041
Loss Detector regression: 0.1367123415936445
Current validation loss: 2.213, Best validation loss: inf at epoch: 0
Elapsed time: 431.50098991394043
Total validation loss decreased from inf to 2.213, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 2/200
 286/1000 [=======>......................] - ETA: 18:58 - rpn_cls: 0.5822 - rpn_regr: 1.0454 - detector_cls: 0.3401 - detector_regr: 0.13532017-11-29 11:08:29.677844: W C:\tf_jenkins\home\worksp
ace\rel-win\M\windows-gpu\PY\36\tensorflow\core\common_runtime\bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a f
ailure, but may mean that there could be performance gains if more memory is available.
1000/1000 [==============================] - 1600s 2s/step - rpn_cls: 0.5480 - rpn_regr: 1.0171 - detector_cls: 0.3186 - detector_regr: 0.1292
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 11.555
Classifier accuracy for bounding boxes from RPN: 0.9308203125
Loss RPN classifier: 0.5191123765275042
Loss RPN regression: 0.9574341311827302
Loss Detector classifier: 0.29786703541036696
Loss Detector regression: 0.12303306774917291
Elapsed time: 3770.404934167862
Best loss for training: 2.922
Total training loss decreased from 2.922 to 1.897, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 412s 771ms/step - rpn_cls: 0.4530 - rpn_regr: 0.9066 - detector_cls: 0.2417 - detector_regr: 0.1100
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 9.313207547169812
Classifier accuracy for bounding boxes from RPN: 0.9308203125
Loss RPN classifier: 0.4684844377210545
Loss RPN regression: 0.8951627068947093
Loss Detector classifier: 0.25550513845181255
Loss Detector regression: 0.11323052720218867
Current validation loss: 1.732, Best validation loss: 2.213 at epoch: 0
Elapsed time: 411.9700255393982
Total validation loss decreased from 2.213 to 1.732, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 3/200
1000/1000 [==============================] - 1606s 2s/step - rpn_cls: 0.4785 - rpn_regr: 0.8139 - detector_cls: 0.2615 - detector_regr: 0.0999
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 12.892
Classifier accuracy for bounding boxes from RPN: 0.93371875
Loss RPN classifier: 0.45134792278304425
Loss RPN regression: 0.8150472373738885
Loss Detector classifier: 0.25831657721649387
Loss Detector regression: 0.09630437270296024
Elapsed time: 5789.159433841705
Best loss for training: 1.897
Total training loss decreased from 1.897 to 1.621, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 411s 769ms/step - rpn_cls: 0.4106 - rpn_regr: 0.6651 - detector_cls: 0.1929 - detector_regr: 0.0674
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 11.188323917137476
Classifier accuracy for bounding boxes from RPN: 0.93371875
Loss RPN classifier: 0.41581179382915184
Loss RPN regression: 0.6680047879490848
Loss Detector classifier: 0.20124984144718014
Loss Detector regression: 0.06886640472345724
Current validation loss: 1.354, Best validation loss: 1.732 at epoch: 1
Elapsed time: 410.97037982940674
Total validation loss decreased from 1.732 to 1.354, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 4/200
1000/1000 [==============================] - 1614s 2s/step - rpn_cls: 0.3903 - rpn_regr: 0.7242 - detector_cls: 0.2306 - detector_regr: 0.0839
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 13.099
Classifier accuracy for bounding boxes from RPN: 0.937828125
Loss RPN classifier: 0.3801516972587365
Loss RPN regression: 0.7165070844907313
Loss Detector classifier: 0.22880826067646923
Loss Detector regression: 0.08411622680333676
Elapsed time: 7815.046134233475
Best loss for training: 1.621
Total training loss decreased from 1.621 to 1.410, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 418s 782ms/step - rpn_cls: 0.3853 - rpn_regr: 0.6666 - detector_cls: 0.2089 - detector_regr: 0.0655
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 13.536723163841808
Classifier accuracy for bounding boxes from RPN: 0.937828125
Loss RPN classifier: 0.3963007247896696
Loss RPN regression: 0.676815052886497
Loss Detector classifier: 0.21950402488576226
Loss Detector regression: 0.07000685909223195
Current validation loss: 1.363, Best validation loss: 1.354 at epoch: 2
Elapsed time: 418.0281445980072
Epoch 5/200
1000/1000 [==============================] - 1614s 2s/step - rpn_cls: 0.4042 - rpn_regr: 0.6837 - detector_cls: 0.2182 - detector_regr: 0.0757
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 13.535
Classifier accuracy for bounding boxes from RPN: 0.94265625
Loss RPN classifier: 0.3670511782949085
Loss RPN regression: 0.6518006979105994
Loss Detector classifier: 0.20514289516303688
Loss Detector regression: 0.07052534273743004
Elapsed time: 9847.516928195953
Best loss for training: 1.410
Total training loss decreased from 1.410 to 1.295, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 423s 793ms/step - rpn_cls: 0.3606 - rpn_regr: 0.5871 - detector_cls: 0.2410 - detector_regr: 0.0787
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.975471698113207
Classifier accuracy for bounding boxes from RPN: 0.94265625
Loss RPN classifier: 0.3718606451339324
Loss RPN regression: 0.5948011179276732
Loss Detector classifier: 0.24217856633921644
Loss Detector regression: 0.08012107132570181
Current validation loss: 1.289, Best validation loss: 1.354 at epoch: 2
Elapsed time: 423.7573869228363
Total validation loss decreased from 1.354 to 1.289, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 6/200
1000/1000 [==============================] - 1614s 2s/step - rpn_cls: 0.3655 - rpn_regr: 0.6229 - detector_cls: 0.2100 - detector_regr: 0.0641
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.346
Classifier accuracy for bounding boxes from RPN: 0.94390625
Loss RPN classifier: 0.33542936799654693
Loss RPN regression: 0.5902391697242856
Loss Detector classifier: 0.1954433279940713
Loss Detector regression: 0.06388282935423922
Elapsed time: 11885.918092012405
Best loss for training: 1.295
Total training loss decreased from 1.295 to 1.185, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 415s 777ms/step - rpn_cls: 0.3712 - rpn_regr: 0.5411 - detector_cls: 0.2234 - detector_regr: 0.0644
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.112994350282486
Classifier accuracy for bounding boxes from RPN: 0.94390625
Loss RPN classifier: 0.37009704841288305
Loss RPN regression: 0.5406761570634802
Loss Detector classifier: 0.22575421804215146
Loss Detector regression: 0.06545360646282716
Current validation loss: 1.202, Best validation loss: 1.289 at epoch: 4
Elapsed time: 415.3089106082916
Total validation loss decreased from 1.289 to 1.202, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 7/200
1000/1000 [==============================] - 1619s 2s/step - rpn_cls: 0.3468 - rpn_regr: 0.5837 - detector_cls: 0.1932 - detector_regr: 0.0613
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.164
Classifier accuracy for bounding boxes from RPN: 0.9423515625
Loss RPN classifier: 0.33851903063253225
Loss RPN regression: 0.5681819478510879
Loss Detector classifier: 0.19791922788876354
Loss Detector regression: 0.06280468801666075
Elapsed time: 13920.274505853653
Best loss for training: 1.185
Total training loss decreased from 1.185 to 1.167, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 421s 788ms/step - rpn_cls: 0.3273 - rpn_regr: 0.6432 - detector_cls: 0.2208 - detector_regr: 0.0608
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.913370998116761
Classifier accuracy for bounding boxes from RPN: 0.9423515625
Loss RPN classifier: 0.3263627265823601
Loss RPN regression: 0.6289076210812348
Loss Detector classifier: 0.22320199785195988
Loss Detector regression: 0.06264653115259526
Current validation loss: 1.241, Best validation loss: 1.202 at epoch: 5
Elapsed time: 421.2057363986969
Epoch 8/200
1000/1000 [==============================] - 1606s 2s/step - rpn_cls: 0.3346 - rpn_regr: 0.5526 - detector_cls: 0.1936 - detector_regr: 0.0606
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.655
Classifier accuracy for bounding boxes from RPN: 0.944296875
Loss RPN classifier: 0.32483492954938187
Loss RPN regression: 0.563232448047027
Loss Detector classifier: 0.18850254360244617
Loss Detector regression: 0.05949113866362018
Elapsed time: 15947.202226400375
Best loss for training: 1.167
Total training loss decreased from 1.167 to 1.136, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 413s 774ms/step - rpn_cls: 0.3474 - rpn_regr: 0.5770 - detector_cls: 0.1848 - detector_regr: 0.0550
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 12.975517890772128
Classifier accuracy for bounding boxes from RPN: 0.944296875
Loss RPN classifier: 0.33599169914188937
Loss RPN regression: 0.5457711362224142
Loss Detector classifier: 0.17935579831228846
Loss Detector regression: 0.053698837204955344
Current validation loss: 1.115, Best validation loss: 1.202 at epoch: 5
Elapsed time: 413.45297265052795
Total validation loss decreased from 1.202 to 1.115, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 9/200
1000/1000 [==============================] - 1620s 2s/step - rpn_cls: 0.2867 - rpn_regr: 0.5070 - detector_cls: 0.1657 - detector_regr: 0.0570
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.515
Classifier accuracy for bounding boxes from RPN: 0.950734375
Loss RPN classifier: 0.2869456245571697
Loss RPN regression: 0.5017498184815049
Loss Detector classifier: 0.1627210241034627
Loss Detector regression: 0.05343436715735152
Elapsed time: 17981.0037419796
Best loss for training: 1.136
Total training loss decreased from 1.136 to 1.005, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 418s 784ms/step - rpn_cls: 0.2926 - rpn_regr: 0.5236 - detector_cls: 0.1865 - detector_regr: 0.0559
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.639622641509433
Classifier accuracy for bounding boxes from RPN: 0.950734375
Loss RPN classifier: 0.2918772560128226
Loss RPN regression: 0.48261729207793286
Loss Detector classifier: 0.17970627303189887
Loss Detector regression: 0.05386885467144426
Current validation loss: 1.008, Best validation loss: 1.115 at epoch: 7
Elapsed time: 418.8663742542267
Total validation loss decreased from 1.115 to 1.008, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 10/200
1000/1000 [==============================] - 1615s 2s/step - rpn_cls: 0.2760 - rpn_regr: 0.4633 - detector_cls: 0.1637 - detector_regr: 0.0527
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.78
Classifier accuracy for bounding boxes from RPN: 0.9499375
Loss RPN classifier: 0.2814486721349074
Loss RPN regression: 0.4746184601862915
Loss Detector classifier: 0.1661765541478453
Loss Detector regression: 0.05101545773554244
Elapsed time: 20015.346108436584
Best loss for training: 1.005
Total training loss decreased from 1.005 to 0.973, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 411s 770ms/step - rpn_cls: 0.3314 - rpn_regr: 0.5389 - detector_cls: 0.1700 - detector_regr: 0.0458
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.184557438794727
Classifier accuracy for bounding boxes from RPN: 0.9499375
Loss RPN classifier: 0.3138188601851337
Loss RPN regression: 0.5397647064290801
Loss Detector classifier: 0.15490242175684635
Loss Detector regression: 0.04275672799798609
Current validation loss: 1.051, Best validation loss: 1.008 at epoch: 8
Elapsed time: 411.62912368774414
Epoch 11/200
1000/1000 [==============================] - 1615s 2s/step - rpn_cls: 0.2898 - rpn_regr: 0.4920 - detector_cls: 0.1693 - detector_regr: 0.0475
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.951
Classifier accuracy for bounding boxes from RPN: 0.9504296875
Loss RPN classifier: 0.29126993985169974
Loss RPN regression: 0.5046814416497946
Loss Detector classifier: 0.1640415284429182
Loss Detector regression: 0.04690392978714181
Elapsed time: 22041.785802602768
Best loss for training: 0.973
534/534 [==============================] - 417s 781ms/step - rpn_cls: 0.3455 - rpn_regr: 0.6859 - detector_cls: 0.2976 - detector_regr: 0.0659
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.285714285714286
Classifier accuracy for bounding boxes from RPN: 0.9504296875
Loss RPN classifier: 0.32243441555299607
Loss RPN regression: 0.6602024844104655
Loss Detector classifier: 0.2878817370604948
Loss Detector regression: 0.06616328988075587
Current validation loss: 1.337, Best validation loss: 1.008 at epoch: 8
Elapsed time: 417.30433464050293
Epoch 12/200
1000/1000 [==============================] - 1612s 2s/step - rpn_cls: 0.2889 - rpn_regr: 0.5269 - detector_cls: 0.1647 - detector_regr: 0.0448
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.266
Classifier accuracy for bounding boxes from RPN: 0.952453125
Loss RPN classifier: 0.2829503986676124
Loss RPN regression: 0.49927939140517263
Loss Detector classifier: 0.15910085915843228
Loss Detector regression: 0.045335663237594415
Elapsed time: 24071.172882080078
Best loss for training: 0.973
534/534 [==============================] - 418s 784ms/step - rpn_cls: 0.2986 - rpn_regr: 0.5243 - detector_cls: 0.1601 - detector_regr: 0.0469
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.015065913370998
Classifier accuracy for bounding boxes from RPN: 0.952453125
Loss RPN classifier: 0.2938020694437825
Loss RPN regression: 0.4935624546053983
Loss Detector classifier: 0.15646666371392623
Loss Detector regression: 0.046756970510954975
Current validation loss: 0.991, Best validation loss: 1.008 at epoch: 8
Elapsed time: 418.5278685092926
Total validation loss decreased from 1.008 to 0.991, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 13/200
1000/1000 [==============================] - 1616s 2s/step - rpn_cls: 0.2608 - rpn_regr: 0.4942 - detector_cls: 0.1412 - detector_regr: 0.0442
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.105
Classifier accuracy for bounding boxes from RPN: 0.956375
Loss RPN classifier: 0.26219825978686445
Loss RPN regression: 0.4631026450637728
Loss Detector classifier: 0.14024156279623276
Loss Detector regression: 0.04239401139729307
Elapsed time: 26106.0064702034
Best loss for training: 0.973
Total training loss decreased from 0.973 to 0.908, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 418s 783ms/step - rpn_cls: 0.3017 - rpn_regr: 0.4362 - detector_cls: 0.1792 - detector_regr: 0.0429
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.143126177024483
Classifier accuracy for bounding boxes from RPN: 0.956375
Loss RPN classifier: 0.2809865890144872
Loss RPN regression: 0.43266582448202906
Loss Detector classifier: 0.1693194922926785
Loss Detector regression: 0.042184673135840525
Current validation loss: 0.925, Best validation loss: 0.991 at epoch: 11
Elapsed time: 418.9395694732666
Total validation loss decreased from 0.991 to 0.925, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 14/200
1000/1000 [==============================] - 1617s 2s/step - rpn_cls: 0.2355 - rpn_regr: 0.4294 - detector_cls: 0.1378 - detector_regr: 0.0440
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.249
Classifier accuracy for bounding boxes from RPN: 0.95540625
Loss RPN classifier: 0.24581552588775354
Loss RPN regression: 0.4224594719996676
Loss Detector classifier: 0.14498743457511593
Loss Detector regression: 0.042639418426217164
Elapsed time: 28142.46551823616
Best loss for training: 0.908
Total training loss decreased from 0.908 to 0.856, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 421s 788ms/step - rpn_cls: 0.3101 - rpn_regr: 0.4915 - detector_cls: 0.1823 - detector_regr: 0.0463
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.295112781954888
Classifier accuracy for bounding boxes from RPN: 0.95540625
Loss RPN classifier: 0.30028360026109396
Loss RPN regression: 0.47672585965123737
Loss Detector classifier: 0.17385577973057273
Loss Detector regression: 0.04391183215694524
Current validation loss: 0.995, Best validation loss: 0.925 at epoch: 12
Elapsed time: 421.18051838874817
Epoch 15/200
1000/1000 [==============================] - 1617s 2s/step - rpn_cls: 0.2631 - rpn_regr: 0.4509 - detector_cls: 0.1413 - detector_regr: 0.0401
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.927
Classifier accuracy for bounding boxes from RPN: 0.955453125
Loss RPN classifier: 0.2682894709473216
Loss RPN regression: 0.4428658341304399
Loss Detector classifier: 0.14371799279742117
Loss Detector regression: 0.03882903124277618
Elapsed time: 30180.52092909813
Best loss for training: 0.856
534/534 [==============================] - 419s 784ms/step - rpn_cls: 0.2885 - rpn_regr: 0.3968 - detector_cls: 0.1809 - detector_regr: 0.0434
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.133709981167609
Classifier accuracy for bounding boxes from RPN: 0.955453125
Loss RPN classifier: 0.27968351056906854
Loss RPN regression: 0.41589982319651136
Loss Detector classifier: 0.17541435501527972
Loss Detector regression: 0.042762513010112524
Current validation loss: 0.914, Best validation loss: 0.925 at epoch: 12
Elapsed time: 418.96467781066895
Total validation loss decreased from 0.925 to 0.914, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 16/200
1000/1000 [==============================] - 1619s 2s/step - rpn_cls: 0.2486 - rpn_regr: 0.4328 - detector_cls: 0.1440 - detector_regr: 0.0385
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.792
Classifier accuracy for bounding boxes from RPN: 0.9568125
Loss RPN classifier: 0.23750354601936857
Loss RPN regression: 0.4468079646988772
Loss Detector classifier: 0.13818687449846767
Loss Detector regression: 0.038614001450536305
Elapsed time: 32218.811787605286
Best loss for training: 0.856
534/534 [==============================] - 421s 789ms/step - rpn_cls: 0.2457 - rpn_regr: 0.4244 - detector_cls: 0.1559 - detector_regr: 0.0401
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.811676082862524
Classifier accuracy for bounding boxes from RPN: 0.9568125
Loss RPN classifier: 0.2697468315221904
Loss RPN regression: 0.4391026128439254
Loss Detector classifier: 0.159455356399857
Loss Detector regression: 0.03800904982142882
Current validation loss: 0.906, Best validation loss: 0.914 at epoch: 14
Elapsed time: 421.3279159069061
Total validation loss decreased from 0.914 to 0.906, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 17/200
1000/1000 [==============================] - 1610s 2s/step - rpn_cls: 0.2383 - rpn_regr: 0.4050 - detector_cls: 0.1401 - detector_regr: 0.0378
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.271
Classifier accuracy for bounding boxes from RPN: 0.95871875
Loss RPN classifier: 0.23929184167284942
Loss RPN regression: 0.3887820792961866
Loss Detector classifier: 0.13178016017159597
Loss Detector regression: 0.03607672029848618
Elapsed time: 34251.02544927597
Best loss for training: 0.856
Total training loss decreased from 0.856 to 0.796, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 418s 784ms/step - rpn_cls: 0.2411 - rpn_regr: 0.4200 - detector_cls: 0.1673 - detector_regr: 0.0483
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.523540489642185
Classifier accuracy for bounding boxes from RPN: 0.95871875
Loss RPN classifier: 0.2643432647016996
Loss RPN regression: 0.44271671007062946
Loss Detector classifier: 0.18127890243241052
Loss Detector regression: 0.05161869448094829
Current validation loss: 0.940, Best validation loss: 0.906 at epoch: 15
Elapsed time: 418.83128118515015
Epoch 18/200
1000/1000 [==============================] - 1614s 2s/step - rpn_cls: 0.2249 - rpn_regr: 0.4117 - detector_cls: 0.1253 - detector_regr: 0.0356
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.484
Classifier accuracy for bounding boxes from RPN: 0.9608671875
Loss RPN classifier: 0.22794458056186362
Loss RPN regression: 0.4039337813612074
Loss Detector classifier: 0.12664587093728438
Loss Detector regression: 0.03548297120941788
Elapsed time: 36283.899629592896
Best loss for training: 0.796
Total training loss decreased from 0.796 to 0.794, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 422s 790ms/step - rpn_cls: 0.2307 - rpn_regr: 0.3753 - detector_cls: 0.1400 - detector_regr: 0.0406
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.022556390977444
Classifier accuracy for bounding boxes from RPN: 0.9608671875
Loss RPN classifier: 0.24659072929575593
Loss RPN regression: 0.3928459222020393
Loss Detector classifier: 0.1476380509087399
Loss Detector regression: 0.042214408238837355
Current validation loss: 0.829, Best validation loss: 0.906 at epoch: 15
Elapsed time: 422.1892147064209
Total validation loss decreased from 0.906 to 0.829, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 19/200
1000/1000 [==============================] - 1613s 2s/step - rpn_cls: 0.2272 - rpn_regr: 0.3928 - detector_cls: 0.1377 - detector_regr: 0.0376
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.097
Classifier accuracy for bounding boxes from RPN: 0.957921875
Loss RPN classifier: 0.22923188585854187
Loss RPN regression: 0.3956901533100754
Loss Detector classifier: 0.13538817191161798
Loss Detector regression: 0.03636637358381995
Elapsed time: 38319.7445640564
Best loss for training: 0.794
534/534 [==============================] - 423s 792ms/step - rpn_cls: 0.2519 - rpn_regr: 0.3844 - detector_cls: 0.1444 - detector_regr: 0.0386
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.17924528301887
Classifier accuracy for bounding boxes from RPN: 0.957921875
Loss RPN classifier: 0.26004504609437296
Loss RPN regression: 0.4050510488450527
Loss Detector classifier: 0.1561484035594591
Loss Detector regression: 0.04095398633458143
Current validation loss: 0.862, Best validation loss: 0.829 at epoch: 17
Elapsed time: 423.1060616970062
Epoch 20/200
1000/1000 [==============================] - 1624s 2s/step - rpn_cls: 0.2141 - rpn_regr: 0.4292 - detector_cls: 0.1261 - detector_regr: 0.0334
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.262
Classifier accuracy for bounding boxes from RPN: 0.961578125
Loss RPN classifier: 0.21478671265804808
Loss RPN regression: 0.41849512945953754
Loss Detector classifier: 0.12237536683254456
Loss Detector regression: 0.03402572332132695
Elapsed time: 40366.703016757965
Best loss for training: 0.794
Total training loss decreased from 0.794 to 0.790, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 422s 790ms/step - rpn_cls: 0.2548 - rpn_regr: 0.3992 - detector_cls: 0.1398 - detector_regr: 0.0363
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.322033898305085
Classifier accuracy for bounding boxes from RPN: 0.961578125
Loss RPN classifier: 0.2593496087275195
Loss RPN regression: 0.4134675230558836
Loss Detector classifier: 0.1446489969294384
Loss Detector regression: 0.03623592852037812
Current validation loss: 0.854, Best validation loss: 0.829 at epoch: 17
Elapsed time: 422.136207818985
Epoch 21/200
1000/1000 [==============================] - 1618s 2s/step - rpn_cls: 0.2313 - rpn_regr: 0.4004 - detector_cls: 0.1202 - detector_regr: 0.0352
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.684
Classifier accuracy for bounding boxes from RPN: 0.9627421875
Loss RPN classifier: 0.2141937469534371
Loss RPN regression: 0.3878086699191481
Loss Detector classifier: 0.11829768749210053
Loss Detector regression: 0.03241132455515253
Elapsed time: 42406.65818119049
Best loss for training: 0.790
Total training loss decreased from 0.790 to 0.753, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 421s 788ms/step - rpn_cls: 0.2379 - rpn_regr: 0.3640 - detector_cls: 0.1408 - detector_regr: 0.0353
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.781544256120528
Classifier accuracy for bounding boxes from RPN: 0.9627421875
Loss RPN classifier: 0.24146184726907352
Loss RPN regression: 0.3696609511518021
Loss Detector classifier: 0.153639665722397
Loss Detector regression: 0.037305579366716725
Current validation loss: 0.802, Best validation loss: 0.829 at epoch: 17
Elapsed time: 421.3018538951874
Total validation loss decreased from 0.829 to 0.802, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 22/200
1000/1000 [==============================] - 1623s 2s/step - rpn_cls: 0.2198 - rpn_regr: 0.3673 - detector_cls: 0.1238 - detector_regr: 0.0324
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.851
Classifier accuracy for bounding boxes from RPN: 0.961296875
Loss RPN classifier: 0.2124724496675757
Loss RPN regression: 0.3583985154684633
Loss Detector classifier: 0.11940470892795929
Loss Detector regression: 0.03229516136675375
Elapsed time: 44450.82174253464
Best loss for training: 0.753
Total training loss decreased from 0.753 to 0.723, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 424s 794ms/step - rpn_cls: 0.2372 - rpn_regr: 0.3944 - detector_cls: 0.1464 - detector_regr: 0.0376
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.026415094339622
Classifier accuracy for bounding boxes from RPN: 0.961296875
Loss RPN classifier: 0.2478457760338726
Loss RPN regression: 0.4039236665197582
Loss Detector classifier: 0.15611574702133918
Loss Detector regression: 0.04003384495526814
Current validation loss: 0.848, Best validation loss: 0.802 at epoch: 20
Elapsed time: 424.625803232193
Epoch 23/200
1000/1000 [==============================] - 1618s 2s/step - rpn_cls: 0.2164 - rpn_regr: 0.3764 - detector_cls: 0.1262 - detector_regr: 0.0309
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.009
Classifier accuracy for bounding boxes from RPN: 0.960671875
Loss RPN classifier: 0.2136565924262959
Loss RPN regression: 0.3623299106052145
Loss Detector classifier: 0.1256780904832458
Loss Detector regression: 0.031064987282676156
Elapsed time: 46493.69390273094
Best loss for training: 0.723
534/534 [==============================] - 422s 790ms/step - rpn_cls: 0.2349 - rpn_regr: 0.3976 - detector_cls: 0.1625 - detector_regr: 0.0415
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.610169491525424
Classifier accuracy for bounding boxes from RPN: 0.960671875
Loss RPN classifier: 0.24026067110220037
Loss RPN regression: 0.3989176917646764
Loss Detector classifier: 0.16931607201056412
Loss Detector regression: 0.042473606783964266
Current validation loss: 0.851, Best validation loss: 0.802 at epoch: 20
Elapsed time: 421.7129406929016
Epoch 24/200
1000/1000 [==============================] - 1621s 2s/step - rpn_cls: 0.2296 - rpn_regr: 0.3843 - detector_cls: 0.1244 - detector_regr: 0.0336
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.842
Classifier accuracy for bounding boxes from RPN: 0.962203125
Loss RPN classifier: 0.21150159025203266
Loss RPN regression: 0.38349647707212714
Loss Detector classifier: 0.12172417504602345
Loss Detector regression: 0.03319524177536368
Elapsed time: 48536.400252342224
Best loss for training: 0.723
534/534 [==============================] - 427s 799ms/step - rpn_cls: 0.2361 - rpn_regr: 0.3909 - detector_cls: 0.1378 - detector_regr: 0.0322
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.103578154425612
Classifier accuracy for bounding boxes from RPN: 0.962203125
Loss RPN classifier: 0.22617996206730456
Loss RPN regression: 0.38080354906227926
Loss Detector classifier: 0.1413713660909121
Loss Detector regression: 0.03301923009303379
Current validation loss: 0.781, Best validation loss: 0.802 at epoch: 20
Elapsed time: 426.75568318367004
Total validation loss decreased from 0.802 to 0.781, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 25/200
1000/1000 [==============================] - 1618s 2s/step - rpn_cls: 0.1888 - rpn_regr: 0.3363 - detector_cls: 0.1081 - detector_regr: 0.0284
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.75
Classifier accuracy for bounding boxes from RPN: 0.9663046875
Loss RPN classifier: 0.1873058362067534
Loss RPN regression: 0.3368755990145728
Loss Detector classifier: 0.1060032541039327
Loss Detector regression: 0.027854625597748962
Elapsed time: 50581.45323252678
Best loss for training: 0.723
Total training loss decreased from 0.723 to 0.658, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 422s 791ms/step - rpn_cls: 0.2564 - rpn_regr: 0.4023 - detector_cls: 0.1417 - detector_regr: 0.0336
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 13.945386064030131
Classifier accuracy for bounding boxes from RPN: 0.9663046875
Loss RPN classifier: 0.23358795631648538
Loss RPN regression: 0.37227763967895494
Loss Detector classifier: 0.1415869627625183
Loss Detector regression: 0.03332054633546512
Current validation loss: 0.781, Best validation loss: 0.781 at epoch: 23
Elapsed time: 422.83190536499023
Total validation loss decreased from 0.781 to 0.781, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 26/200
1000/1000 [==============================] - 1622s 2s/step - rpn_cls: 0.2099 - rpn_regr: 0.3744 - detector_cls: 0.1086 - detector_regr: 0.0292
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.036
Classifier accuracy for bounding boxes from RPN: 0.9642890625
Loss RPN classifier: 0.2033794296012444
Loss RPN regression: 0.34500396157521757
Loss Detector classifier: 0.11050223494119564
Loss Detector regression: 0.030548446882734424
Elapsed time: 52627.032269239426
Best loss for training: 0.658
534/534 [==============================] - 427s 799ms/step - rpn_cls: 0.2759 - rpn_regr: 0.4210 - detector_cls: 0.1984 - detector_regr: 0.0453
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 17.334586466165412
Classifier accuracy for bounding boxes from RPN: 0.9642890625
Loss RPN classifier: 0.26607455771655714
Loss RPN regression: 0.40809134111045564
Loss Detector classifier: 0.1896187692476447
Loss Detector regression: 0.04396668424709283
Current validation loss: 0.908, Best validation loss: 0.781 at epoch: 24
Elapsed time: 426.55883979797363
Epoch 27/200
 999/1000 [============================>.] - ETA: 1s - rpn_cls: 0.2088 - rpn_regr: 0.3781 - detector_cls: 0.1198 - detector_regr: 0.0293[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.719
Classifier accuracy for bounding boxes from RPN: 0.96321875
Loss RPN classifier: 0.19881306369109883
Loss RPN regression: 0.350229062860366
Loss Detector classifier: 0.11611955308320149
Loss Detector regression: 0.029159638097400603
Elapsed time: 54667.18564772606
Best loss for training: 0.658
534/534 [==============================] - 422s 790ms/step - rpn_cls: 0.2414 - rpn_regr: 0.3905 - detector_cls: 0.1441 - detector_regr: 0.0379
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.881578947368421
Classifier accuracy for bounding boxes from RPN: 0.96321875
Loss RPN classifier: 0.23044885670192783
Loss RPN regression: 0.3792564076779599
Loss Detector classifier: 0.14264599089327615
Loss Detector regression: 0.036851434059101164
Current validation loss: 0.789, Best validation loss: 0.781 at epoch: 24
Elapsed time: 421.6417586803436
Epoch 28/200
1000/1000 [==============================] - 1625s 2s/step - rpn_cls: 0.1991 - rpn_regr: 0.3645 - detector_cls: 0.1122 - detector_regr: 0.0302
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.146
Classifier accuracy for bounding boxes from RPN: 0.963625
Loss RPN classifier: 0.20163174099536926
Loss RPN regression: 0.36230913146864624
Loss Detector classifier: 0.11482734335001442
Loss Detector regression: 0.03080173792252026
Elapsed time: 56713.36671447754
Best loss for training: 0.658
534/534 [==============================] - 425s 795ms/step - rpn_cls: 0.2518 - rpn_regr: 0.4046 - detector_cls: 0.1675 - detector_regr: 0.0384
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 17.513157894736842
Classifier accuracy for bounding boxes from RPN: 0.963625
Loss RPN classifier: 0.2374200599577709
Loss RPN regression: 0.38653798984217175
Loss Detector classifier: 0.15622927261340303
Loss Detector regression: 0.037746745407568685
Current validation loss: 0.818, Best validation loss: 0.781 at epoch: 24
Elapsed time: 424.63071036338806
Epoch 29/200
1000/1000 [==============================] - 1618s 2s/step - rpn_cls: 0.1880 - rpn_regr: 0.3486 - detector_cls: 0.1064 - detector_regr: 0.0303
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.807
Classifier accuracy for bounding boxes from RPN: 0.9676953125
Loss RPN classifier: 0.18036601490308055
Loss RPN regression: 0.3358083489462733
Loss Detector classifier: 0.10189256669566657
Loss Detector regression: 0.028588720140900477
Elapsed time: 58756.1875038147
Best loss for training: 0.658
Total training loss decreased from 0.658 to 0.647, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 427s 800ms/step - rpn_cls: 0.2468 - rpn_regr: 0.3831 - detector_cls: 0.1598 - detector_regr: 0.0349
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 17.19360902255639
Classifier accuracy for bounding boxes from RPN: 0.9676953125
Loss RPN classifier: 0.2311641429445332
Loss RPN regression: 0.36678707651612574
Loss Detector classifier: 0.14663298434337205
Loss Detector regression: 0.03452847866046727
Current validation loss: 0.779, Best validation loss: 0.781 at epoch: 24
Elapsed time: 427.3845102787018
Total validation loss decreased from 0.781 to 0.779, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 30/200
1000/1000 [==============================] - 1624s 2s/step - rpn_cls: 0.1833 - rpn_regr: 0.3110 - detector_cls: 0.1029 - detector_regr: 0.0265
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.5
Classifier accuracy for bounding boxes from RPN: 0.9671015625
Loss RPN classifier: 0.1839540753922555
Loss RPN regression: 0.30670037172501907
Loss Detector classifier: 0.10411945788797311
Loss Detector regression: 0.027572994185415155
Elapsed time: 60807.59889006615
Best loss for training: 0.647
Total training loss decreased from 0.647 to 0.622, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 418s 784ms/step - rpn_cls: 0.2374 - rpn_regr: 0.3834 - detector_cls: 0.1606 - detector_regr: 0.0415
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.08286252354049
Classifier accuracy for bounding boxes from RPN: 0.9671015625
Loss RPN classifier: 0.21389099109931334
Loss RPN regression: 0.37985115780666023
Loss Detector classifier: 0.14318425158232326
Loss Detector regression: 0.04017312275258798
Current validation loss: 0.777, Best validation loss: 0.779 at epoch: 28
Elapsed time: 418.84832859039307
Total validation loss decreased from 0.779 to 0.777, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 31/200
1000/1000 [==============================] - 1619s 2s/step - rpn_cls: 0.1922 - rpn_regr: 0.3361 - detector_cls: 0.1090 - detector_regr: 0.0282
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.052
Classifier accuracy for bounding boxes from RPN: 0.9653828125
Loss RPN classifier: 0.18521584528472812
Loss RPN regression: 0.34480534376809374
Loss Detector classifier: 0.10980796410214907
Loss Detector regression: 0.028607473947759785
Elapsed time: 62845.88830137253
Best loss for training: 0.622
534/534 [==============================] - 424s 795ms/step - rpn_cls: 0.2364 - rpn_regr: 0.3721 - detector_cls: 0.1488 - detector_regr: 0.0353
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.443609022556391
Classifier accuracy for bounding boxes from RPN: 0.9653828125
Loss RPN classifier: 0.229849435622494
Loss RPN regression: 0.3648038228576103
Loss Detector classifier: 0.1478955650531856
Loss Detector regression: 0.03610049808665873
Current validation loss: 0.779, Best validation loss: 0.777 at epoch: 29
Elapsed time: 424.33993124961853
Epoch 32/200
1000/1000 [==============================] - 1629s 2s/step - rpn_cls: 0.1815 - rpn_regr: 0.3331 - detector_cls: 0.1087 - detector_regr: 0.0275
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.513
Classifier accuracy for bounding boxes from RPN: 0.9645234375
Loss RPN classifier: 0.19062329642792947
Loss RPN regression: 0.3314237428852357
Loss Detector classifier: 0.109957546088394
Loss Detector regression: 0.02796594317275594
Elapsed time: 64899.70376777649
Best loss for training: 0.622
534/534 [==============================] - 424s 794ms/step - rpn_cls: 0.2176 - rpn_regr: 0.3362 - detector_cls: 0.1568 - detector_regr: 0.0372
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.659774436090224
Classifier accuracy for bounding boxes from RPN: 0.9645234375
Loss RPN classifier: 0.21402533467025311
Loss RPN regression: 0.3521894768067053
Loss Detector classifier: 0.14991253325850826
Loss Detector regression: 0.03517295464456091
Current validation loss: 0.751, Best validation loss: 0.777 at epoch: 29
Elapsed time: 424.0922780036926
Total validation loss decreased from 0.777 to 0.751, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 33/200
1000/1000 [==============================] - 1619s 2s/step - rpn_cls: 0.1634 - rpn_regr: 0.3114 - detector_cls: 0.0961 - detector_regr: 0.0253
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.608
Classifier accuracy for bounding boxes from RPN: 0.9686328125
Loss RPN classifier: 0.16738448728008004
Loss RPN regression: 0.30922350665507836
Loss Detector classifier: 0.09658411993985674
Loss Detector regression: 0.025049288351876385
Elapsed time: 66943.34821748734
Best loss for training: 0.622
Total training loss decreased from 0.622 to 0.598, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 426s 797ms/step - rpn_cls: 0.1895 - rpn_regr: 0.3339 - detector_cls: 0.1362 - detector_regr: 0.0360
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.607142857142858
Classifier accuracy for bounding boxes from RPN: 0.9686328125
Loss RPN classifier: 0.208033114282089
Loss RPN regression: 0.3516828974408938
Loss Detector classifier: 0.14393242666806197
Loss Detector regression: 0.03550000057194335
Current validation loss: 0.739, Best validation loss: 0.751 at epoch: 31
Elapsed time: 425.971271276474
Total validation loss decreased from 0.751 to 0.739, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 34/200
1000/1000 [==============================] - 1624s 2s/step - rpn_cls: 0.1709 - rpn_regr: 0.3282 - detector_cls: 0.0972 - detector_regr: 0.0264
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.64
Classifier accuracy for bounding boxes from RPN: 0.9687421875
Loss RPN classifier: 0.17199768392797182
Loss RPN regression: 0.33401692597940563
Loss Detector classifier: 0.09780646289416473
Loss Detector regression: 0.026562595696028438
Elapsed time: 68993.32421875
Best loss for training: 0.598
534/534 [==============================] - 422s 791ms/step - rpn_cls: 0.2150 - rpn_regr: 0.3277 - detector_cls: 0.1366 - detector_regr: 0.0304
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.167293233082706
Classifier accuracy for bounding boxes from RPN: 0.9687421875
Loss RPN classifier: 0.23285625946880192
Loss RPN regression: 0.34584138784139007
Loss Detector classifier: 0.14378601667976568
Loss Detector regression: 0.030772062129001104
Current validation loss: 0.753, Best validation loss: 0.739 at epoch: 32
Elapsed time: 422.32502460479736
Epoch 35/200
1000/1000 [==============================] - 1627s 2s/step - rpn_cls: 0.1835 - rpn_regr: 0.2994 - detector_cls: 0.0982 - detector_regr: 0.0269
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.692
Classifier accuracy for bounding boxes from RPN: 0.968421875
Loss RPN classifier: 0.17639454325530596
Loss RPN regression: 0.3053517083823681
Loss Detector classifier: 0.09862438703836234
Loss Detector regression: 0.02661107863525649
Elapsed time: 71042.66404533386
Best loss for training: 0.598
534/534 [==============================] - 423s 792ms/step - rpn_cls: 0.1971 - rpn_regr: 0.3537 - detector_cls: 0.1462 - detector_regr: 0.0383
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.943609022556391
Classifier accuracy for bounding boxes from RPN: 0.968421875
Loss RPN classifier: 0.209242516246521
Loss RPN regression: 0.3612621003615387
Loss Detector classifier: 0.1532365826998385
Loss Detector regression: 0.040055825193244195
Current validation loss: 0.764, Best validation loss: 0.739 at epoch: 32
Elapsed time: 423.0140974521637
Epoch 36/200
1000/1000 [==============================] - 1622s 2s/step - rpn_cls: 0.1666 - rpn_regr: 0.3079 - detector_cls: 0.1010 - detector_regr: 0.0260
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.498
Classifier accuracy for bounding boxes from RPN: 0.96775
Loss RPN classifier: 0.17340740011855363
Loss RPN regression: 0.31210668927244845
Loss Detector classifier: 0.1022220388580281
Loss Detector regression: 0.02638610676987264
Elapsed time: 73088.07982873917
Best loss for training: 0.598
534/534 [==============================] - 426s 797ms/step - rpn_cls: 0.2260 - rpn_regr: 0.3429 - detector_cls: 0.1229 - detector_regr: 0.0304
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.086466165413533
Classifier accuracy for bounding boxes from RPN: 0.96775
Loss RPN classifier: 0.234931642882756
Loss RPN regression: 0.34222153362151836
Loss Detector classifier: 0.13572080365391617
Loss Detector regression: 0.03234149906718349
Current validation loss: 0.745, Best validation loss: 0.739 at epoch: 32
Elapsed time: 425.8820388317108
Epoch 37/200
1000/1000 [==============================] - 1624s 2s/step - rpn_cls: 0.1668 - rpn_regr: 0.3047 - detector_cls: 0.1027 - detector_regr: 0.0261
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.815
Classifier accuracy for bounding boxes from RPN: 0.96934375
Loss RPN classifier: 0.1670267144164976
Loss RPN regression: 0.2928329403270036
Loss Detector classifier: 0.096005740606568
Loss Detector regression: 0.024760461303660122
Elapsed time: 75137.49739837646
Best loss for training: 0.598
Total training loss decreased from 0.598 to 0.581, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 424s 794ms/step - rpn_cls: 0.2179 - rpn_regr: 0.3525 - detector_cls: 0.1369 - detector_regr: 0.0303
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.659774436090224
Classifier accuracy for bounding boxes from RPN: 0.96934375
Loss RPN classifier: 0.22090465734502865
Loss RPN regression: 0.3608910546233452
Loss Detector classifier: 0.146248250014804
Loss Detector regression: 0.032195083981588386
Current validation loss: 0.760, Best validation loss: 0.739 at epoch: 32
Elapsed time: 424.5665626525879
Epoch 38/200
1000/1000 [==============================] - 1621s 2s/step - rpn_cls: 0.1635 - rpn_regr: 0.2957 - detector_cls: 0.0861 - detector_regr: 0.0229
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.443
Classifier accuracy for bounding boxes from RPN: 0.9716796875
Loss RPN classifier: 0.1616540399434336
Loss RPN regression: 0.3032625205721706
Loss Detector classifier: 0.08890496842336143
Loss Detector regression: 0.02345519930091177
Elapsed time: 77182.67632699013
Best loss for training: 0.581
Total training loss decreased from 0.581 to 0.577, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 426s 798ms/step - rpn_cls: 0.2028 - rpn_regr: 0.3254 - detector_cls: 0.1444 - detector_regr: 0.0345
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.362781954887218
Classifier accuracy for bounding boxes from RPN: 0.9716796875
Loss RPN classifier: 0.22151349211822777
Loss RPN regression: 0.33756121531763716
Loss Detector classifier: 0.15323986076896035
Loss Detector regression: 0.03486737332651443
Current validation loss: 0.747, Best validation loss: 0.739 at epoch: 32
Elapsed time: 426.67517280578613
Epoch 39/200
1000/1000 [==============================] - 1628s 2s/step - rpn_cls: 0.1572 - rpn_regr: 0.2800 - detector_cls: 0.0915 - detector_regr: 0.0245
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.619
Classifier accuracy for bounding boxes from RPN: 0.9703515625
Loss RPN classifier: 0.16998445934887135
Loss RPN regression: 0.29142260063719005
Loss Detector classifier: 0.09484988913752158
Loss Detector regression: 0.024659954736001966
Elapsed time: 79237.47135591507
Best loss for training: 0.577
534/534 [==============================] - 422s 790ms/step - rpn_cls: 0.1861 - rpn_regr: 0.3266 - detector_cls: 0.1316 - detector_regr: 0.0310
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.555555555555555
Classifier accuracy for bounding boxes from RPN: 0.9703515625
Loss RPN classifier: 0.1948176740539048
Loss RPN regression: 0.33375908223186596
Loss Detector classifier: 0.14384332948234277
Loss Detector regression: 0.03237236059193788
Current validation loss: 0.705, Best validation loss: 0.739 at epoch: 32
Elapsed time: 422.12103366851807
Total validation loss decreased from 0.739 to 0.705, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 40/200
1000/1000 [==============================] - 1632s 2s/step - rpn_cls: 0.1702 - rpn_regr: 0.3170 - detector_cls: 0.1027 - detector_regr: 0.0264
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.181
Classifier accuracy for bounding boxes from RPN: 0.9677421875
Loss RPN classifier: 0.16946054138778627
Loss RPN regression: 0.3214690718068741
Loss Detector classifier: 0.10006223131792785
Loss Detector regression: 0.026082594145380427
Elapsed time: 81291.55186319351
Best loss for training: 0.577
534/534 [==============================] - 427s 800ms/step - rpn_cls: 0.2123 - rpn_regr: 0.3382 - detector_cls: 0.1515 - detector_regr: 0.0361
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.87218045112782
Classifier accuracy for bounding boxes from RPN: 0.9677421875
Loss RPN classifier: 0.21390082915669872
Loss RPN regression: 0.34736523735912495
Loss Detector classifier: 0.15546655101314494
Loss Detector regression: 0.034817369732970775
Current validation loss: 0.752, Best validation loss: 0.705 at epoch: 38
Elapsed time: 427.2450623512268
Epoch 41/200
1000/1000 [==============================] - 1619s 2s/step - rpn_cls: 0.1600 - rpn_regr: 0.2743 - detector_cls: 0.0877 - detector_regr: 0.0246
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.361
Classifier accuracy for bounding boxes from RPN: 0.971921875
Loss RPN classifier: 0.16485409981615515
Loss RPN regression: 0.2785557345161214
Loss Detector classifier: 0.08862616416787569
Loss Detector regression: 0.02373191006031993
Elapsed time: 83337.95922589302
Best loss for training: 0.577
Total training loss decreased from 0.577 to 0.556, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 422s 790ms/step - rpn_cls: 0.2240 - rpn_regr: 0.3316 - detector_cls: 0.1433 - detector_regr: 0.0300
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.516917293233083
Classifier accuracy for bounding boxes from RPN: 0.971921875
Loss RPN classifier: 0.22917878686329082
Loss RPN regression: 0.33222827103254055
Loss Detector classifier: 0.14824358578974509
Loss Detector regression: 0.03046081925560075
Current validation loss: 0.740, Best validation loss: 0.705 at epoch: 38
Elapsed time: 422.13039231300354
Epoch 42/200
1000/1000 [==============================] - 1628s 2s/step - rpn_cls: 0.1657 - rpn_regr: 0.2995 - detector_cls: 0.0835 - detector_regr: 0.0228
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.324
Classifier accuracy for bounding boxes from RPN: 0.9726328125
Loss RPN classifier: 0.15803406762326075
Loss RPN regression: 0.2963662157971412
Loss Detector classifier: 0.08554835815104889
Loss Detector regression: 0.023213918394671053
Elapsed time: 85388.35126852989
Best loss for training: 0.556
534/534 [==============================] - 442s 829ms/step - rpn_cls: 0.2274 - rpn_regr: 0.3570 - detector_cls: 0.1447 - detector_regr: 0.0302
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.487758945386064
Classifier accuracy for bounding boxes from RPN: 0.9726328125
Loss RPN classifier: 0.21368425538493196
Loss RPN regression: 0.33734035317538386
Loss Detector classifier: 0.1434599137271485
Loss Detector regression: 0.030959527644350355
Current validation loss: 0.725, Best validation loss: 0.705 at epoch: 38
Elapsed time: 442.4952437877655
Epoch 43/200
1000/1000 [==============================] - 1628s 2s/step - rpn_cls: 0.1768 - rpn_regr: 0.3018 - detector_cls: 0.0907 - detector_regr: 0.0242
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.064
Classifier accuracy for bounding boxes from RPN: 0.9698671875
Loss RPN classifier: 0.16914982718657007
Loss RPN regression: 0.28682084861025214
Loss Detector classifier: 0.09467129382069106
Loss Detector regression: 0.02333338821217876
Elapsed time: 87458.80491757393
Best loss for training: 0.556
534/534 [==============================] - 423s 792ms/step - rpn_cls: 0.2180 - rpn_regr: 0.3555 - detector_cls: 0.1508 - detector_regr: 0.0338
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.80639097744361
Classifier accuracy for bounding boxes from RPN: 0.9698671875
Loss RPN classifier: 0.21465849753091612
Loss RPN regression: 0.3387885389122275
Loss Detector classifier: 0.14859357806361256
Loss Detector regression: 0.03289858013202265
Current validation loss: 0.735, Best validation loss: 0.705 at epoch: 38
Elapsed time: 423.0424840450287
Epoch 44/200
1000/1000 [==============================] - 1618s 2s/step - rpn_cls: 0.1570 - rpn_regr: 0.2783 - detector_cls: 0.0975 - detector_regr: 0.0264
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.467
Classifier accuracy for bounding boxes from RPN: 0.969203125
Loss RPN classifier: 0.16108360458541435
Loss RPN regression: 0.2942598097613081
Loss Detector classifier: 0.0967502344119522
Loss Detector regression: 0.02567203700420214
Elapsed time: 89499.72588706017
Best loss for training: 0.556
534/534 [==============================] - 423s 793ms/step - rpn_cls: 0.2383 - rpn_regr: 0.3476 - detector_cls: 0.1479 - detector_regr: 0.0341
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.67984934086629
Classifier accuracy for bounding boxes from RPN: 0.969203125
Loss RPN classifier: 0.22671704360434014
Loss RPN regression: 0.3372058858519441
Loss Detector classifier: 0.14574816457924625
Loss Detector regression: 0.031484111816588965
Current validation loss: 0.741, Best validation loss: 0.705 at epoch: 38
Elapsed time: 423.5327923297882
Epoch 45/200
1000/1000 [==============================] - 1621s 2s/step - rpn_cls: 0.1516 - rpn_regr: 0.2676 - detector_cls: 0.0894 - detector_regr: 0.0225
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.528
Classifier accuracy for bounding boxes from RPN: 0.9720234375
Loss RPN classifier: 0.15465354678024681
Loss RPN regression: 0.26234852375858464
Loss Detector classifier: 0.08650024180369109
Loss Detector regression: 0.022689669305153076
Elapsed time: 91544.46393823624
Best loss for training: 0.556
Total training loss decreased from 0.556 to 0.526, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 423s 792ms/step - rpn_cls: 0.1960 - rpn_regr: 0.3633 - detector_cls: 0.1670 - detector_regr: 0.0351
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.5093984962406
Classifier accuracy for bounding boxes from RPN: 0.9720234375
Loss RPN classifier: 0.19162397003922846
Loss RPN regression: 0.34731499706865865
Loss Detector classifier: 0.16107937514045964
Loss Detector regression: 0.034044710278275
Current validation loss: 0.734, Best validation loss: 0.705 at epoch: 38
Elapsed time: 423.44455432891846
Epoch 46/200
1000/1000 [==============================] - 1623s 2s/step - rpn_cls: 0.1422 - rpn_regr: 0.2656 - detector_cls: 0.0771 - detector_regr: 0.0215
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.295
Classifier accuracy for bounding boxes from RPN: 0.974453125
Loss RPN classifier: 0.1490837760238988
Loss RPN regression: 0.278730754529126
Loss Detector classifier: 0.07901335868773822
Loss Detector regression: 0.02190619907567816
Elapsed time: 93590.74434447289
Best loss for training: 0.526
534/534 [==============================] - 421s 788ms/step - rpn_cls: 0.2582 - rpn_regr: 0.3624 - detector_cls: 0.1463 - detector_regr: 0.0306
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.954887218045112
Classifier accuracy for bounding boxes from RPN: 0.974453125
Loss RPN classifier: 0.21915188854848888
Loss RPN regression: 0.3429835545708345
Loss Detector classifier: 0.1337374235716858
Loss Detector regression: 0.03076023060650309
Current validation loss: 0.727, Best validation loss: 0.705 at epoch: 38
Elapsed time: 420.8717315196991
Epoch 47/200
1000/1000 [==============================] - 1611s 2s/step - rpn_cls: 0.1674 - rpn_regr: 0.2713 - detector_cls: 0.0879 - detector_regr: 0.0215
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.292
Classifier accuracy for bounding boxes from RPN: 0.972296875
Loss RPN classifier: 0.16140532543345354
Loss RPN regression: 0.27962111426144837
Loss Detector classifier: 0.08638194939005281
Loss Detector regression: 0.021878134658145428
Elapsed time: 95622.61846137047
Best loss for training: 0.526
534/534 [==============================] - 421s 789ms/step - rpn_cls: 0.2263 - rpn_regr: 0.3502 - detector_cls: 0.1713 - detector_regr: 0.0334
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.924812030075188
Classifier accuracy for bounding boxes from RPN: 0.972296875
Loss RPN classifier: 0.20448667820073127
Loss RPN regression: 0.34065639621086335
Loss Detector classifier: 0.15211573952719915
Loss Detector regression: 0.032260173036311825
Current validation loss: 0.730, Best validation loss: 0.705 at epoch: 38
Elapsed time: 421.4783236980438
Epoch 48/200
1000/1000 [==============================] - 1626s 2s/step - rpn_cls: 0.1544 - rpn_regr: 0.2782 - detector_cls: 0.0843 - detector_regr: 0.0210
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.684
Classifier accuracy for bounding boxes from RPN: 0.9723828125
Loss RPN classifier: 0.15180341200717884
Loss RPN regression: 0.2829325603032485
Loss Detector classifier: 0.0841679587628114
Loss Detector regression: 0.021424724237789634
Elapsed time: 97669.85133934021
Best loss for training: 0.526
534/534 [==============================] - 422s 791ms/step - rpn_cls: 0.2418 - rpn_regr: 0.3495 - detector_cls: 0.1641 - detector_regr: 0.0320
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.56578947368421
Classifier accuracy for bounding boxes from RPN: 0.9723828125
Loss RPN classifier: 0.23270093800351205
Loss RPN regression: 0.33845411067870396
Loss Detector classifier: 0.1538090368938165
Loss Detector regression: 0.0313684790125547
Current validation loss: 0.756, Best validation loss: 0.705 at epoch: 38
Elapsed time: 422.4629921913147
Not improved validation accuracy for 8 epochs. Reducing learning rate from 1.0 to 0.5
Epoch 49/200
1000/1000 [==============================] - 1623s 2s/step - rpn_cls: 0.1467 - rpn_regr: 0.2513 - detector_cls: 0.0668 - detector_regr: 0.0173
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.553
Classifier accuracy for bounding boxes from RPN: 0.9795
Loss RPN classifier: 0.13767021893300135
Loss RPN regression: 0.22780386691726745
Loss Detector classifier: 0.06288585213611077
Loss Detector regression: 0.01632678486378427
Elapsed time: 99716.19873285294
Best loss for training: 0.526
Total training loss decreased from 0.526 to 0.445, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 426s 799ms/step - rpn_cls: 0.2198 - rpn_regr: 0.3039 - detector_cls: 0.1509 - detector_regr: 0.0270
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.103383458646615
Classifier accuracy for bounding boxes from RPN: 0.9795
Loss RPN classifier: 0.20867419708521662
Loss RPN regression: 0.3090751641325318
Loss Detector classifier: 0.14267305028872646
Loss Detector regression: 0.02623078330857033
Current validation loss: 0.687, Best validation loss: 0.705 at epoch: 38
Elapsed time: 426.84159207344055
Total validation loss decreased from 0.705 to 0.687, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 50/200
1000/1000 [==============================] - 1637s 2s/step - rpn_cls: 0.1181 - rpn_regr: 0.2141 - detector_cls: 0.0570 - detector_regr: 0.0156
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 14.711
Classifier accuracy for bounding boxes from RPN: 0.982296875
Loss RPN classifier: 0.12211030657671204
Loss RPN regression: 0.21890071416529827
Loss Detector classifier: 0.053518416786982485
Loss Detector regression: 0.014170321977182085
Elapsed time: 101780.06623649597
Best loss for training: 0.445
Total training loss decreased from 0.445 to 0.409, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 429s 803ms/step - rpn_cls: 0.1808 - rpn_regr: 0.2745 - detector_cls: 0.1290 - detector_regr: 0.0255
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.458646616541353
Classifier accuracy for bounding boxes from RPN: 0.982296875
Loss RPN classifier: 0.20404559802193237
Loss RPN regression: 0.29256991909516883
Loss Detector classifier: 0.13432520005344462
Loss Detector regression: 0.02620670055422918
Current validation loss: 0.657, Best validation loss: 0.687 at epoch: 48
Elapsed time: 429.2520043849945
Total validation loss decreased from 0.687 to 0.657, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 51/200
1000/1000 [==============================] - 1634s 2s/step - rpn_cls: 0.1198 - rpn_regr: 0.2217 - detector_cls: 0.0540 - detector_regr: 0.0151
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.783
Classifier accuracy for bounding boxes from RPN: 0.9809765625
Loss RPN classifier: 0.12230634116531874
Loss RPN regression: 0.21517895456776023
Loss Detector classifier: 0.0565761335275879
Loss Detector regression: 0.01553073488512655
Elapsed time: 103843.28291153908
Best loss for training: 0.409
534/534 [==============================] - 429s 803ms/step - rpn_cls: 0.1826 - rpn_regr: 0.2802 - detector_cls: 0.1307 - detector_regr: 0.0257
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.210526315789473
Classifier accuracy for bounding boxes from RPN: 0.9809765625
Loss RPN classifier: 0.19139811450023922
Loss RPN regression: 0.2908243098878738
Loss Detector classifier: 0.13828098216786944
Loss Detector regression: 0.02637242514549811
Current validation loss: 0.647, Best validation loss: 0.657 at epoch: 49
Elapsed time: 428.7155668735504
Total validation loss decreased from 0.657 to 0.647, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4.hdf5
Epoch 52/200
1000/1000 [==============================] - 1634s 2s/step - rpn_cls: 0.1233 - rpn_regr: 0.2135 - detector_cls: 0.0541 - detector_regr: 0.0169
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.232
Classifier accuracy for bounding boxes from RPN: 0.9816953125
Loss RPN classifier: 0.1299897392594971
Loss RPN regression: 0.2177936680619605
Loss Detector classifier: 0.05581160919943411
Loss Detector regression: 0.01632366565297707
Elapsed time: 105906.04133868217
Best loss for training: 0.409
534/534 [==============================] - 431s 807ms/step - rpn_cls: 0.2005 - rpn_regr: 0.3078 - detector_cls: 0.1202 - detector_regr: 0.0273
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.913533834586467
Classifier accuracy for bounding boxes from RPN: 0.9816953125
Loss RPN classifier: 0.20685833919889224
Loss RPN regression: 0.3089367988125215
Loss Detector classifier: 0.13788230038956206
Loss Detector regression: 0.02758556112145724
Current validation loss: 0.681, Best validation loss: 0.647 at epoch: 50
Elapsed time: 431.05077290534973
Epoch 53/200
1000/1000 [==============================] - 1625s 2s/step - rpn_cls: 0.1137 - rpn_regr: 0.2063 - detector_cls: 0.0523 - detector_regr: 0.0135
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.093
Classifier accuracy for bounding boxes from RPN: 0.984484375
Loss RPN classifier: 0.116792594210182
Loss RPN regression: 0.18655850399885093
Loss Detector classifier: 0.04839876916620849
Loss Detector regression: 0.013458126742632885
Elapsed time: 107961.69753098488
Best loss for training: 0.409
Total training loss decreased from 0.409 to 0.365, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 429s 804ms/step - rpn_cls: 0.1935 - rpn_regr: 0.2697 - detector_cls: 0.1362 - detector_regr: 0.0258
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.06766917293233
Classifier accuracy for bounding boxes from RPN: 0.984484375
Loss RPN classifier: 0.19931752456715318
Loss RPN regression: 0.2930880626750768
Loss Detector classifier: 0.15061250263015744
Loss Detector regression: 0.027179470326404186
Current validation loss: 0.670, Best validation loss: 0.647 at epoch: 50
Elapsed time: 429.4605596065521
Epoch 54/200
1000/1000 [==============================] - 1636s 2s/step - rpn_cls: 0.1164 - rpn_regr: 0.1941 - detector_cls: 0.0469 - detector_regr: 0.0137
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.208
Classifier accuracy for bounding boxes from RPN: 0.984609375
Loss RPN classifier: 0.1164398944395643
Loss RPN regression: 0.2037391457952326
Loss Detector classifier: 0.04744101849559502
Loss Detector regression: 0.013516637428099785
Elapsed time: 110026.99382996559
Best loss for training: 0.365
534/534 [==============================] - 429s 804ms/step - rpn_cls: 0.2153 - rpn_regr: 0.2745 - detector_cls: 0.1364 - detector_regr: 0.0250
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.05639097744361
Classifier accuracy for bounding boxes from RPN: 0.984609375
Loss RPN classifier: 0.23401140276305335
Loss RPN regression: 0.2903490620612931
Loss Detector classifier: 0.14734102296026516
Loss Detector regression: 0.026906198808542576
Current validation loss: 0.699, Best validation loss: 0.647 at epoch: 50
Elapsed time: 429.34324836730957
Epoch 55/200
1000/1000 [==============================] - 1636s 2s/step - rpn_cls: 0.1142 - rpn_regr: 0.2058 - detector_cls: 0.0447 - detector_regr: 0.0141
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.985
Classifier accuracy for bounding boxes from RPN: 0.9851171875
Loss RPN classifier: 0.11594453834039586
Loss RPN regression: 0.20225982673326506
Loss Detector classifier: 0.047222516374923855
Loss Detector regression: 0.01381707148087662
Elapsed time: 112092.5676252842
Best loss for training: 0.365
533/534 [============================>.] - ETA: 0s - rpn_cls: 0.1804 - rpn_regr: 0.2826 - detector_cls: 0.1413 - detector_regr: 0.0259[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.934086629001884
Classifier accuracy for bounding boxes from RPN: 0.9851171875
Loss RPN classifier: 0.19605079316733492
Loss RPN regression: 0.28833697206420955
Loss Detector classifier: 0.14636480750433695
Loss Detector regression: 0.02653018168327234
Current validation loss: 0.657, Best validation loss: 0.647 at epoch: 50
Elapsed time: 428.55615735054016
Epoch 56/200
1000/1000 [==============================] - 1638s 2s/step - rpn_cls: 0.1175 - rpn_regr: 0.2011 - detector_cls: 0.0465 - detector_regr: 0.0151
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.722
Classifier accuracy for bounding boxes from RPN: 0.984171875
Loss RPN classifier: 0.11390370277879162
Loss RPN regression: 0.20173462372459472
Loss Detector classifier: 0.04865686314234364
Loss Detector regression: 0.014832379000160927
Elapsed time: 114158.89005231857
Best loss for training: 0.365
534/534 [==============================] - 431s 807ms/step - rpn_cls: 0.1962 - rpn_regr: 0.2998 - detector_cls: 0.1422 - detector_regr: 0.0251
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.1296992481203
Classifier accuracy for bounding boxes from RPN: 0.984171875
Loss RPN classifier: 0.201766373060031
Loss RPN regression: 0.2993789283028535
Loss Detector classifier: 0.1480174998184408
Loss Detector regression: 0.02597186062042495
Current validation loss: 0.675, Best validation loss: 0.647 at epoch: 50
Elapsed time: 430.73896074295044
Epoch 57/200
1000/1000 [==============================] - 1632s 2s/step - rpn_cls: 0.1102 - rpn_regr: 0.1904 - detector_cls: 0.0440 - detector_regr: 0.0130
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.823
Classifier accuracy for bounding boxes from RPN: 0.9862109375
Loss RPN classifier: 0.10688019022902756
Loss RPN regression: 0.17813493921933696
Loss Detector classifier: 0.042042809459806846
Loss Detector regression: 0.012911248543724468
Elapsed time: 116221.19543528557
Best loss for training: 0.365
Total training loss decreased from 0.365 to 0.340, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 430s 805ms/step - rpn_cls: 0.2302 - rpn_regr: 0.2942 - detector_cls: 0.1560 - detector_regr: 0.0245
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.919172932330827
Classifier accuracy for bounding boxes from RPN: 0.9862109375
Loss RPN classifier: 0.22833294461004383
Loss RPN regression: 0.2956910468637943
Loss Detector classifier: 0.16193176476358004
Loss Detector regression: 0.02563100473904778
Current validation loss: 0.712, Best validation loss: 0.647 at epoch: 50
Elapsed time: 430.2015287876129
Epoch 58/200
1000/1000 [==============================] - 1632s 2s/step - rpn_cls: 0.1058 - rpn_regr: 0.1912 - detector_cls: 0.0380 - detector_regr: 0.0113
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.369
Classifier accuracy for bounding boxes from RPN: 0.9867109375
Loss RPN classifier: 0.10529384320932916
Loss RPN regression: 0.18352091942343396
Loss Detector classifier: 0.0413993106778081
Loss Detector regression: 0.011830590159443091
Elapsed time: 118283.52690315247
Best loss for training: 0.340
534/534 [==============================] - 431s 808ms/step - rpn_cls: 0.2016 - rpn_regr: 0.2865 - detector_cls: 0.1516 - detector_regr: 0.0263
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.676691729323307
Classifier accuracy for bounding boxes from RPN: 0.9867109375
Loss RPN classifier: 0.20721617195969266
Loss RPN regression: 0.2874331520556399
Loss Detector classifier: 0.1556486021318308
Loss Detector regression: 0.027122683894750966
Current validation loss: 0.677, Best validation loss: 0.647 at epoch: 50
Elapsed time: 431.51103949546814
Epoch 59/200
1000/1000 [==============================] - 1634s 2s/step - rpn_cls: 0.1089 - rpn_regr: 0.1915 - detector_cls: 0.0428 - detector_regr: 0.0127
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.29
Classifier accuracy for bounding boxes from RPN: 0.986234375
Loss RPN classifier: 0.11158780972354758
Loss RPN regression: 0.19335832063527778
Loss Detector classifier: 0.042111211110851525
Loss Detector regression: 0.013095505426118962
Elapsed time: 120349.16508579254
Best loss for training: 0.340
534/534 [==============================] - 429s 803ms/step - rpn_cls: 0.1989 - rpn_regr: 0.3111 - detector_cls: 0.1597 - detector_regr: 0.0280
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.71186440677966
Classifier accuracy for bounding boxes from RPN: 0.986234375
Loss RPN classifier: 0.20367217800617457
Loss RPN regression: 0.2973258298253187
Loss Detector classifier: 0.1603824547285096
Loss Detector regression: 0.028550126965255027
Current validation loss: 0.690, Best validation loss: 0.647 at epoch: 50
Elapsed time: 428.8719928264618
Epoch 60/200
1000/1000 [==============================] - 1630s 2s/step - rpn_cls: 0.1144 - rpn_regr: 0.1951 - detector_cls: 0.0419 - detector_regr: 0.0142
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.122
Classifier accuracy for bounding boxes from RPN: 0.9852265625
Loss RPN classifier: 0.1171372217553935
Loss RPN regression: 0.19172088953573257
Loss Detector classifier: 0.04414530865618303
Loss Detector regression: 0.013794596651614484
Elapsed time: 122408.48054099083
Best loss for training: 0.340
534/534 [==============================] - 429s 803ms/step - rpn_cls: 0.2122 - rpn_regr: 0.3066 - detector_cls: 0.1600 - detector_regr: 0.0273
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.291353383458645
Classifier accuracy for bounding boxes from RPN: 0.9852265625
Loss RPN classifier: 0.2129452053155872
Loss RPN regression: 0.289333402930867
Loss Detector classifier: 0.1613347968492967
Loss Detector regression: 0.027127848421541752
Current validation loss: 0.691, Best validation loss: 0.647 at epoch: 50
Elapsed time: 429.0815510749817
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.5 to 0.25
Epoch 61/200
1000/1000 [==============================] - 1634s 2s/step - rpn_cls: 0.0987 - rpn_regr: 0.1705 - detector_cls: 0.0351 - detector_regr: 0.0119
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.621
Classifier accuracy for bounding boxes from RPN: 0.98965625
Loss RPN classifier: 0.0968888021084677
Loss RPN regression: 0.15806145919300615
Loss Detector classifier: 0.031812853444803335
Loss Detector regression: 0.010558755518337421
Elapsed time: 124471.37813544273
Best loss for training: 0.340
Total training loss decreased from 0.340 to 0.297, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 429s 804ms/step - rpn_cls: 0.2199 - rpn_regr: 0.3009 - detector_cls: 0.1631 - detector_regr: 0.0285
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.1203007518797
Classifier accuracy for bounding boxes from RPN: 0.98965625
Loss RPN classifier: 0.20545501773277622
Loss RPN regression: 0.2817728225671955
Loss Detector classifier: 0.16355645440173516
Loss Detector regression: 0.026999677675496044
Current validation loss: 0.678, Best validation loss: 0.647 at epoch: 50
Elapsed time: 429.53576731681824
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.25 to 0.125
Epoch 62/200
1000/1000 [==============================] - 1634s 2s/step - rpn_cls: 0.1042 - rpn_regr: 0.1674 - detector_cls: 0.0278 - detector_regr: 0.0089
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.794
Classifier accuracy for bounding boxes from RPN: 0.991875
Loss RPN classifier: 0.09867747285082012
Loss RPN regression: 0.16260496344766578
Loss Detector classifier: 0.026279853261859103
Loss Detector regression: 0.009159703235062351
Elapsed time: 126535.14634609222
Best loss for training: 0.297
Total training loss decreased from 0.297 to 0.297, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 428s 802ms/step - rpn_cls: 0.2202 - rpn_regr: 0.2986 - detector_cls: 0.1679 - detector_regr: 0.0252
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.31578947368421
Classifier accuracy for bounding boxes from RPN: 0.991875
Loss RPN classifier: 0.21125747037660422
Loss RPN regression: 0.283685080874502
Loss Detector classifier: 0.1620801129439858
Loss Detector regression: 0.02539470832310345
Current validation loss: 0.682, Best validation loss: 0.647 at epoch: 50
Elapsed time: 428.54212379455566
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.125 to 0.0625
Epoch 63/200
1000/1000 [==============================] - 1632s 2s/step - rpn_cls: 0.0876 - rpn_regr: 0.1358 - detector_cls: 0.0235 - detector_regr: 0.0087
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.447
Classifier accuracy for bounding boxes from RPN: 0.992015625
Loss RPN classifier: 0.09041713984598035
Loss RPN regression: 0.14054522261279634
Loss Detector classifier: 0.024856852546596257
Loss Detector regression: 0.009216520800941907
Elapsed time: 128595.56376338005
Best loss for training: 0.297
Total training loss decreased from 0.297 to 0.265, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 428s 801ms/step - rpn_cls: 0.2394 - rpn_regr: 0.2698 - detector_cls: 0.1877 - detector_regr: 0.0274
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.81015037593985
Classifier accuracy for bounding boxes from RPN: 0.992015625
Loss RPN classifier: 0.2191299491189253
Loss RPN regression: 0.27260268946990984
Loss Detector classifier: 0.1744854019572925
Loss Detector regression: 0.025954173118459996
Current validation loss: 0.692, Best validation loss: 0.647 at epoch: 50
Elapsed time: 428.3115088939667
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.0625 to 0.03125
Epoch 64/200
1000/1000 [==============================] - 1631s 2s/step - rpn_cls: 0.0767 - rpn_regr: 0.1328 - detector_cls: 0.0244 - detector_regr: 0.0085
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.174
Classifier accuracy for bounding boxes from RPN: 0.9922890625
Loss RPN classifier: 0.08654825921249021
Loss RPN regression: 0.13403303000354208
Loss Detector classifier: 0.025202411207298398
Loss Detector regression: 0.009281515470557224
Elapsed time: 130655.32200169563
Best loss for training: 0.265
Total training loss decreased from 0.265 to 0.255, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 428s 801ms/step - rpn_cls: 0.2373 - rpn_regr: 0.2805 - detector_cls: 0.1938 - detector_regr: 0.0284
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.43984962406015
Classifier accuracy for bounding boxes from RPN: 0.9922890625
Loss RPN classifier: 0.2212181867912793
Loss RPN regression: 0.27863434708262147
Loss Detector classifier: 0.17297783345732248
Loss Detector regression: 0.026573369637626302
Current validation loss: 0.699, Best validation loss: 0.647 at epoch: 50
Elapsed time: 428.08792448043823
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.03125 to 0.015625
Epoch 65/200
1000/1000 [==============================] - 1633s 2s/step - rpn_cls: 0.0883 - rpn_regr: 0.1262 - detector_cls: 0.0251 - detector_regr: 0.0084
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.886
Classifier accuracy for bounding boxes from RPN: 0.9934765625
Loss RPN classifier: 0.08625224689243903
Loss RPN regression: 0.12335971818468533
Loss Detector classifier: 0.021128788101900525
Loss Detector regression: 0.008240515383341631
Elapsed time: 132716.11160755157
Best loss for training: 0.255
Total training loss decreased from 0.255 to 0.239, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 426s 797ms/step - rpn_cls: 0.2563 - rpn_regr: 0.2589 - detector_cls: 0.1825 - detector_regr: 0.0266
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.718045112781954
Classifier accuracy for bounding boxes from RPN: 0.9934765625
Loss RPN classifier: 0.23140611015773666
Loss RPN regression: 0.27104628068126374
Loss Detector classifier: 0.17547246979788944
Loss Detector regression: 0.025954030976131248
Current validation loss: 0.704, Best validation loss: 0.647 at epoch: 50
Elapsed time: 425.9111168384552
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.015625 to 0.0078125
Epoch 66/200
1000/1000 [==============================] - 1637s 2s/step - rpn_cls: 0.0844 - rpn_regr: 0.1346 - detector_cls: 0.0197 - detector_regr: 0.0078
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.524
Classifier accuracy for bounding boxes from RPN: 0.99384375
Loss RPN classifier: 0.08897789923822438
Loss RPN regression: 0.13223946158963373
Loss Detector classifier: 0.021074851807724983
Loss Detector regression: 0.007903916105860845
Elapsed time: 134778.7865371704
Best loss for training: 0.239
534/534 [==============================] - 430s 805ms/step - rpn_cls: 0.2263 - rpn_regr: 0.2627 - detector_cls: 0.1746 - detector_regr: 0.0270
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.51127819548872
Classifier accuracy for bounding boxes from RPN: 0.99384375
Loss RPN classifier: 0.2302556728461544
Loss RPN regression: 0.2732157361055358
Loss Detector classifier: 0.17565633215175092
Loss Detector regression: 0.0260895291806133
Current validation loss: 0.705, Best validation loss: 0.647 at epoch: 50
Elapsed time: 429.9859573841095
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.0078125 to 0.00390625
Epoch 67/200
1000/1000 [==============================] - 1631s 2s/step - rpn_cls: 0.0795 - rpn_regr: 0.1358 - detector_cls: 0.0186 - detector_regr: 0.0070
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.354
Classifier accuracy for bounding boxes from RPN: 0.99409375
Loss RPN classifier: 0.08465293769753074
Loss RPN regression: 0.13461099067446775
Loss Detector classifier: 0.020203192064594575
Loss Detector regression: 0.0074959312995054005
Elapsed time: 136839.78845763206
Best loss for training: 0.239
534/534 [==============================] - 430s 806ms/step - rpn_cls: 0.2016 - rpn_regr: 0.2528 - detector_cls: 0.1656 - detector_regr: 0.0243
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.387218045112782
Classifier accuracy for bounding boxes from RPN: 0.99409375
Loss RPN classifier: 0.22036907134955366
Loss RPN regression: 0.26794588940099495
Loss Detector classifier: 0.16926376095299703
Loss Detector regression: 0.025007267670427307
Current validation loss: 0.683, Best validation loss: 0.647 at epoch: 50
Elapsed time: 430.28209686279297
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.00390625 to 0.001953125
Epoch 68/200
1000/1000 [==============================] - 1636s 2s/step - rpn_cls: 0.0817 - rpn_regr: 0.1385 - detector_cls: 0.0195 - detector_regr: 0.0078
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.239
Classifier accuracy for bounding boxes from RPN: 0.9940234375
Loss RPN classifier: 0.08180591977239361
Loss RPN regression: 0.1345506323784357
Loss Detector classifier: 0.01959455816727312
Loss Detector regression: 0.007900362408089678
Elapsed time: 138905.85659742355
Best loss for training: 0.239
534/534 [==============================] - 430s 805ms/step - rpn_cls: 0.2186 - rpn_regr: 0.2647 - detector_cls: 0.1788 - detector_regr: 0.0263
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.69736842105263
Classifier accuracy for bounding boxes from RPN: 0.9940234375
Loss RPN classifier: 0.22930559367022652
Loss RPN regression: 0.26869390698931134
Loss Detector classifier: 0.1812788489634771
Loss Detector regression: 0.02610419266452584
Current validation loss: 0.705, Best validation loss: 0.647 at epoch: 50
Elapsed time: 429.8265130519867
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.001953125 to 0.0009765625
Epoch 69/200
1000/1000 [==============================] - 1631s 2s/step - rpn_cls: 0.0857 - rpn_regr: 0.1377 - detector_cls: 0.0189 - detector_regr: 0.0077
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.606
Classifier accuracy for bounding boxes from RPN: 0.9941796875
Loss RPN classifier: 0.08764877955850245
Loss RPN regression: 0.13228184398944723
Loss Detector classifier: 0.019867970407722483
Loss Detector regression: 0.007191884215908431
Elapsed time: 140967.0565984249
Best loss for training: 0.239
534/534 [==============================] - 430s 806ms/step - rpn_cls: 0.2075 - rpn_regr: 0.2823 - detector_cls: 0.1527 - detector_regr: 0.0251
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.293233082706767
Classifier accuracy for bounding boxes from RPN: 0.9941796875
Loss RPN classifier: 0.2254990291743034
Loss RPN regression: 0.2762545439683264
Loss Detector classifier: 0.1712163734279614
Loss Detector regression: 0.025564362650187532
Current validation loss: 0.699, Best validation loss: 0.647 at epoch: 50
Elapsed time: 430.23061180114746
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.0009765625 to 0.00048828125
Epoch 70/200
1000/1000 [==============================] - 1634s 2s/step - rpn_cls: 0.0887 - rpn_regr: 0.1302 - detector_cls: 0.0167 - detector_regr: 0.0082
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 15.734
Classifier accuracy for bounding boxes from RPN: 0.9949765625
Loss RPN classifier: 0.08544060985392879
Loss RPN regression: 0.12824039819603786
Loss Detector classifier: 0.01725786119513242
Loss Detector regression: 0.00794048859617601
Elapsed time: 143031.32421803474
Best loss for training: 0.239
Total training loss decreased from 0.239 to 0.239, saving weights to 2017-11-29_128-region-proposals_600-nonmax-boxes_ResNet50_muscima_pp_4_training.hdf5
534/534 [==============================] - 429s 803ms/step - rpn_cls: 0.2136 - rpn_regr: 0.2596 - detector_cls: 0.1597 - detector_regr: 0.0244
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.219924812030076
Classifier accuracy for bounding boxes from RPN: 0.9949765625
Loss RPN classifier: 0.2220384389786838
Loss RPN regression: 0.2706748568069204
Loss Detector classifier: 0.17303466521713456
Loss Detector regression: 0.0257556789931854
Current validation loss: 0.692, Best validation loss: 0.647 at epoch: 50
Elapsed time: 429.3732440471649
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.00048828125 to 0.000244140625
Epoch 71/200
1000/1000 [==============================] - 1638s 2s/step - rpn_cls: 0.0830 - rpn_regr: 0.1287 - detector_cls: 0.0204 - detector_regr: 0.0078
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.359
Classifier accuracy for bounding boxes from RPN: 0.9940234375
Loss RPN classifier: 0.0848134250266704
Loss RPN regression: 0.13051080853643363
Loss Detector classifier: 0.02006842845568586
Loss Detector regression: 0.007742216609069601
Elapsed time: 145099.04189538956
Best loss for training: 0.239
534/534 [==============================] - 430s 805ms/step - rpn_cls: 0.2193 - rpn_regr: 0.2600 - detector_cls: 0.1610 - detector_regr: 0.0234
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.343984962406015
Classifier accuracy for bounding boxes from RPN: 0.9940234375
Loss RPN classifier: 0.226730208982741
Loss RPN regression: 0.27285544004130846
Loss Detector classifier: 0.1716484686526603
Loss Detector regression: 0.02499728580139166
Current validation loss: 0.696, Best validation loss: 0.647 at epoch: 50
Elapsed time: 429.82855558395386
Not improved validation accuracy for 8 epochs. Reducing learning rate from 0.000244140625 to 0.0001220703125
Epoch 72/200
1000/1000 [==============================] - 1628s 2s/step - rpn_cls: 0.0801 - rpn_regr: 0.1372 - detector_cls: 0.0206 - detector_regr: 0.0078
[INFO TRAINING]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.204
Classifier accuracy for bounding boxes from RPN: 0.9938828125
Loss RPN classifier: 0.08305175410185171
Loss RPN regression: 0.13031183916796
Loss Detector classifier: 0.020770251544959366
Loss Detector regression: 0.008081180570678952
Elapsed time: 147156.91338157654
Best loss for training: 0.239
534/534 [==============================] - 429s 803ms/step - rpn_cls: 0.2019 - rpn_regr: 0.2522 - detector_cls: 0.1719 - detector_regr: 0.0261
[INFO VALIDATION]
Mean number of bounding boxes from RPN overlapping ground truth boxes: 16.327683615819208
Classifier accuracy for bounding boxes from RPN: 0.9938828125
Loss RPN classifier: 0.21847872016697237
Loss RPN regression: 0.2671194199859845
Loss Detector classifier: 0.1734970941484886
Loss Detector regression: 0.025824107154247114
Current validation loss: 0.685, Best validation loss: 0.647 at epoch: 50
Elapsed time: 428.7727301120758
Early stopping training after 21 epochs without improvement on validation set
Execution time: 147585.7s
Uploading results to Google Spreadsheet and appending at first empty line 29
**********************
Windows PowerShell transcript end
End time: 20171201032436
**********************
